{"version":3,"file":"main.min.js","mappings":"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","sources":["webpack://navier-stokes-webgl/./src/ts/brush.ts","webpack://navier-stokes-webgl/./src/ts/dynamic-obstacle-controller.ts","webpack://navier-stokes-webgl/./src/ts/dynamic-obstacle.ts","webpack://navier-stokes-webgl/./src/ts/fluid.ts","webpack://navier-stokes-webgl/./src/ts/gl-utils/fbo.ts","webpack://navier-stokes-webgl/./src/ts/gl-utils/gl-resource.ts","webpack://navier-stokes-webgl/./src/ts/gl-utils/shader.ts","webpack://navier-stokes-webgl/./src/ts/gl-utils/utils.ts","webpack://navier-stokes-webgl/./src/ts/gl-utils/vbo.ts","webpack://navier-stokes-webgl/./src/ts/main.ts","webpack://navier-stokes-webgl/./src/ts/mouse-point-renderer.ts","webpack://navier-stokes-webgl/./src/ts/obstacle-map.ts","webpack://navier-stokes-webgl/./src/ts/parameters.ts","webpack://navier-stokes-webgl/./src/ts/requirements.ts","webpack://navier-stokes-webgl/./src/ts/shaders/brush-shaders.ts","webpack://navier-stokes-webgl/./src/ts/shaders/build-shaders.ts","webpack://navier-stokes-webgl/./src/ts/shaders/fluid-shaders.ts","webpack://navier-stokes-webgl/./src/ts/shaders/obstacle-map-shaders.ts","webpack://navier-stokes-webgl/./src/ts/ws-mouse.ts","webpack://navier-stokes-webgl/webpack/bootstrap","webpack://navier-stokes-webgl/webpack/startup"],"sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar gl_resource_1 = __importDefault(require(\"./gl-utils/gl-resource\"));\nvar Parameters = __importStar(require(\"./parameters\"));\nvar BrushShaders = __importStar(require(\"./shaders/brush-shaders\"));\nvar Brush = (function (_super) {\n    __extends(Brush, _super);\n    function Brush(gl) {\n        var _this = _super.call(this, gl) || this;\n        _this._drawShader = BrushShaders.buildDrawShader(gl);\n        _this.thickness = 2;\n        return _this;\n    }\n    Brush.prototype.freeGLResources = function () {\n        this._drawShader.freeGLResources();\n    };\n    Brush.prototype.draw = function () {\n        var gl = _super.prototype.gl.call(this);\n        var canvas = gl.canvas;\n        var canvasSize = [canvas.clientWidth, canvas.clientHeight];\n        var drawShader = this._drawShader;\n        drawShader.use();\n        var brushSize = [\n            Parameters.brush.radius / canvasSize[0],\n            Parameters.brush.radius / canvasSize[1]\n        ];\n        drawShader.u[\"uBrushSize\"].value = brushSize;\n        drawShader.u[\"uBrushPos\"].value = Parameters.mouse.pos;\n        drawShader.u[\"uThickness\"].value = this.thickness / Parameters.brush.radius;\n        drawShader.bindUniformsAndAttributes();\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    };\n    return Brush;\n}(gl_resource_1.default));\nexports.default = Brush;\n","\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DynamicObstacleController = void 0;\nvar DynamicObstacleController = (function () {\n    function DynamicObstacleController(obstacleMap, mouseRenderer) {\n        this.controlPanel = null;\n        this.obstacleMap = obstacleMap;\n        this.mouseRenderer = mouseRenderer;\n        this.config = {\n            enabled: false,\n            autoCreate: false,\n            maxObstacles: 10,\n            defaultMass: 1.0,\n            defaultFriction: 0.95,\n            defaultRestitution: 0.8,\n            defaultSize: [0.06, 0.06]\n        };\n        this.createControlPanel();\n    }\n    DynamicObstacleController.prototype.setEnabled = function (enabled) {\n        this.config.enabled = enabled;\n        if (!enabled) {\n            this.obstacleMap.clearDynamicObstacles();\n            this.mouseRenderer.updateDynamicObstacles([]);\n        }\n        this.updateControlPanel();\n    };\n    DynamicObstacleController.prototype.isEnabled = function () {\n        return this.config.enabled;\n    };\n    DynamicObstacleController.prototype.addObstacle = function (pos, size, mass, friction, restitution) {\n        if (!this.config.enabled) {\n            console.warn(\"\");\n            return null;\n        }\n        var obstacles = this.obstacleMap.getDynamicObstacles();\n        if (obstacles.length >= this.config.maxObstacles) {\n            console.warn(\"\\u5DF2\\u9054\\u5230\\u6700\\u5927\\u969C\\u7919\\u7269\\u6578\\u91CF\\u9650\\u5236: \".concat(this.config.maxObstacles));\n            return null;\n        }\n        var finalPos = pos || [Math.random() * 0.6 + 0.2, Math.random() * 0.6 + 0.2];\n        var finalSize = size || this.config.defaultSize;\n        var finalMass = mass !== undefined ? mass : this.config.defaultMass;\n        var finalFriction = friction !== undefined ? friction : this.config.defaultFriction;\n        var finalRestitution = restitution !== undefined ? restitution : this.config.defaultRestitution;\n        var obstacle = this.obstacleMap.createDynamicObstacle(finalPos, finalSize, finalMass, finalFriction, finalRestitution);\n        this.mouseRenderer.updateDynamicObstacles(this.obstacleMap.getDynamicObstacles());\n        this.updateControlPanel();\n        console.log(\"\\u5275\\u5EFA\\u52D5\\u614B\\u969C\\u7919\\u7269 ID: \".concat(obstacle.id));\n        return obstacle;\n    };\n    DynamicObstacleController.prototype.removeObstacle = function (id) {\n        if (!this.config.enabled)\n            return;\n        var obstacles = this.obstacleMap.getDynamicObstacles();\n        var obstacle = obstacles.find(function (obs) { return obs.id === id; });\n        if (obstacle) {\n            this.obstacleMap.getDynamicObstacles().splice(this.obstacleMap.getDynamicObstacles().indexOf(obstacle), 1);\n            this.mouseRenderer.updateDynamicObstacles(this.obstacleMap.getDynamicObstacles());\n            this.updateControlPanel();\n            console.log(\"\\u79FB\\u9664\\u52D5\\u614B\\u969C\\u7919\\u7269 ID: \".concat(id));\n        }\n    };\n    DynamicObstacleController.prototype.clearAllObstacles = function () {\n        this.obstacleMap.clearDynamicObstacles();\n        this.mouseRenderer.updateDynamicObstacles([]);\n        this.updateControlPanel();\n        console.log(\"\");\n    };\n    DynamicObstacleController.prototype.updateConfig = function (newConfig) {\n        this.config = __assign(__assign({}, this.config), newConfig);\n        this.updateControlPanel();\n    };\n    DynamicObstacleController.prototype.getConfig = function () {\n        return __assign({}, this.config);\n    };\n    DynamicObstacleController.prototype.createControlPanel = function () {\n        this.controlPanel = document.createElement('div');\n        this.controlPanel.id = 'dynamic-obstacle-control';\n        this.controlPanel.style.cssText = \"\\n      position: fixed;\\n      top: 10px;\\n      right: 10px;\\n      background: rgba(0, 0, 0, 0.8);\\n      color: white;\\n      padding: 15px;\\n      border-radius: 8px;\\n      font-family: Arial, sans-serif;\\n      font-size: 12px;\\n      z-index: 1000;\\n      min-width: 200px;\\n    \";\n        this.updateControlPanel();\n        document.body.appendChild(this.controlPanel);\n    };\n    DynamicObstacleController.prototype.updateControlPanel = function () {\n        if (!this.controlPanel)\n            return;\n        var obstacles = this.obstacleMap.getDynamicObstacles();\n        this.controlPanel.innerHTML = \"\\n      <h3 style=\\\"margin: 0 0 10px 0; color: #fff;\\\">\\u52D5\\u614B\\u969C\\u7919\\u7269\\u63A7\\u5236</h3>\\n      \\n      <div style=\\\"margin-bottom: 10px;\\\">\\n        <label>\\n          <input type=\\\"checkbox\\\" id=\\\"enableToggle\\\" \".concat(this.config.enabled ? 'checked' : '', \">\\n          \\u555F\\u7528\\u52D5\\u614B\\u969C\\u7919\\u7269\\n        </label>\\n      </div>\\n      \\n      \").concat(this.config.enabled ? \"\\n        <div style=\\\"border-top: 1px solid #666; padding-top: 10px;\\\">\\n          <div style=\\\"margin-bottom: 8px;\\\">\\n            <label>\\u6700\\u5927\\u6578\\u91CF: \\n              <input type=\\\"number\\\" id=\\\"maxObstacles\\\" value=\\\"\".concat(this.config.maxObstacles, \"\\\" \\n                     min=\\\"1\\\" max=\\\"50\\\" style=\\\"width: 50px;\\\">\\n            </label>\\n          </div>\\n          \\n          <div style=\\\"margin-bottom: 8px;\\\">\\n            <label>\\u9810\\u8A2D\\u8CEA\\u91CF: \\n              <input type=\\\"number\\\" id=\\\"defaultMass\\\" value=\\\"\").concat(this.config.defaultMass, \"\\\" \\n                     min=\\\"0.1\\\" max=\\\"10\\\" step=\\\"0.1\\\" style=\\\"width: 50px;\\\">\\n            </label>\\n          </div>\\n          \\n          <div style=\\\"margin-bottom: 8px;\\\">\\n            <label>\\u6469\\u64E6\\u4FC2\\u6578: \\n              <input type=\\\"number\\\" id=\\\"defaultFriction\\\" value=\\\"\").concat(this.config.defaultFriction, \"\\\" \\n                     min=\\\"0\\\" max=\\\"1\\\" step=\\\"0.05\\\" style=\\\"width: 50px;\\\">\\n            </label>\\n          </div>\\n          \\n          <div style=\\\"margin-bottom: 8px;\\\">\\n            <label>\\u5F48\\u6027\\u4FC2\\u6578: \\n              <input type=\\\"number\\\" id=\\\"defaultRestitution\\\" value=\\\"\").concat(this.config.defaultRestitution, \"\\\" \\n                     min=\\\"0\\\" max=\\\"1\\\" step=\\\"0.1\\\" style=\\\"width: 50px;\\\">\\n            </label>\\n          </div>\\n          \\n          <div style=\\\"margin: 10px 0;\\\">\\n            <button id=\\\"addObstacle\\\" style=\\\"padding: 5px 10px; margin-right: 5px;\\\">\\n              \\u6DFB\\u52A0\\u969C\\u7919\\u7269\\n            </button>\\n            <button id=\\\"clearObstacles\\\" style=\\\"padding: 5px 10px;\\\">\\n              \\u6E05\\u9664\\u5168\\u90E8\\n            </button>\\n          </div>\\n          \\n          <div style=\\\"border-top: 1px solid #666; padding-top: 8px; font-size: 11px;\\\">\\n            <div>\\u7576\\u524D\\u969C\\u7919\\u7269: \").concat(obstacles.length, \"/\").concat(this.config.maxObstacles, \"</div>\\n            \").concat(obstacles.length > 0 ? \"\\n              <div style=\\\"max-height: 100px; overflow-y: auto; margin-top: 5px;\\\">\\n                \".concat(obstacles.map(function (obs) { return \"\\n                  <div style=\\\"display: flex; justify-content: space-between; align-items: center; margin: 2px 0;\\\">\\n                    <span>ID \".concat(obs.id, \" (M:\").concat(obs.mass.toFixed(1), \")</span>\\n                    <button onclick=\\\"window.dynamicObstacleController?.removeObstacle(\").concat(obs.id, \")\\\" \\n                            style=\\\"padding: 1px 5px; font-size: 10px;\\\">\\u79FB\\u9664</button>\\n                  </div>\\n                \"); }).join(''), \"\\n              </div>\\n            \") : '', \"\\n          </div>\\n        </div>\\n      \") : '', \"\\n    \");\n        this.bindControlEvents();\n    };\n    DynamicObstacleController.prototype.bindControlEvents = function () {\n        var _this = this;\n        if (!this.controlPanel)\n            return;\n        var enableToggle = this.controlPanel.querySelector('#enableToggle');\n        if (enableToggle) {\n            enableToggle.addEventListener('change', function (e) {\n                _this.setEnabled(e.target.checked);\n            });\n        }\n        ['maxObstacles', 'defaultMass', 'defaultFriction', 'defaultRestitution'].forEach(function (id) {\n            var input = _this.controlPanel.querySelector(\"#\".concat(id));\n            if (input) {\n                input.addEventListener('change', function () {\n                    var value = parseFloat(input.value);\n                    if (id === 'maxObstacles') {\n                        _this.config.maxObstacles = value;\n                    }\n                    else if (id === 'defaultMass') {\n                        _this.config.defaultMass = value;\n                    }\n                    else if (id === 'defaultFriction') {\n                        _this.config.defaultFriction = value;\n                    }\n                    else if (id === 'defaultRestitution') {\n                        _this.config.defaultRestitution = value;\n                    }\n                });\n            }\n        });\n        var addButton = this.controlPanel.querySelector('#addObstacle');\n        if (addButton) {\n            addButton.addEventListener('click', function () {\n                _this.addObstacle();\n            });\n        }\n        var clearButton = this.controlPanel.querySelector('#clearObstacles');\n        if (clearButton) {\n            clearButton.addEventListener('click', function () {\n                _this.clearAllObstacles();\n            });\n        }\n        window.dynamicObstacleController = this;\n    };\n    DynamicObstacleController.prototype.update = function (mousePoints, deltaTime) {\n        if (!this.config.enabled)\n            return;\n        this.obstacleMap.updateDynamicObstacles(mousePoints, deltaTime);\n        this.mouseRenderer.updateDynamicObstacles(this.obstacleMap.getDynamicObstacles());\n    };\n    DynamicObstacleController.prototype.destroy = function () {\n        if (this.controlPanel && this.controlPanel.parentElement) {\n            this.controlPanel.parentElement.removeChild(this.controlPanel);\n        }\n        delete window.dynamicObstacleController;\n    };\n    return DynamicObstacleController;\n}());\nexports.DynamicObstacleController = DynamicObstacleController;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DynamicObstacleSystem = void 0;\nvar DynamicObstacleSystem = (function () {\n    function DynamicObstacleSystem(canvasWidth, canvasHeight) {\n        this.obstacles = [];\n        this.nextId = 0;\n        this.canvasWidth = canvasWidth;\n        this.canvasHeight = canvasHeight;\n    }\n    DynamicObstacleSystem.prototype.createObstacle = function (pos, size, mass, friction, restitution) {\n        if (size === void 0) { size = [0.02, 0.02]; }\n        if (mass === void 0) { mass = 1.0; }\n        if (friction === void 0) { friction = 0.95; }\n        if (restitution === void 0) { restitution = 0.8; }\n        var obstacle = {\n            pos: pos,\n            vel: [0, 0],\n            size: size,\n            mass: mass,\n            friction: friction,\n            restitution: restitution,\n            id: this.nextId++\n        };\n        this.obstacles.push(obstacle);\n        return obstacle;\n    };\n    DynamicObstacleSystem.prototype.checkPointObstacleCollision = function (point, obstacle) {\n        var dx = point.pos[0] - obstacle.pos[0];\n        var dy = point.pos[1] - obstacle.pos[1];\n        var distance = Math.sqrt(dx * dx + dy * dy);\n        var pointRadius = 0.01;\n        var obstacleRadius = (obstacle.size[0] + obstacle.size[1]) * 0.5;\n        var collisionDistance = pointRadius + obstacleRadius;\n        var isCollision = distance < collisionDistance;\n        if (isCollision) {\n            console.log(\"\\uD83D\\uDD25 \\u78B0\\u649E\\u6AA2\\u6E2C\\u6210\\u529F! \\n        \\u9EDE\\u4F4D\\u7F6E: [\".concat(point.pos[0].toFixed(3), \", \").concat(point.pos[1].toFixed(3), \"]\\n        \\u969C\\u7919\\u7269\\u4F4D\\u7F6E: [\").concat(obstacle.pos[0].toFixed(3), \", \").concat(obstacle.pos[1].toFixed(3), \"]\\n        \\u8DDD\\u96E2: \").concat(distance.toFixed(4), \"\\n        \\u78B0\\u649E\\u95BE\\u503C: \").concat(collisionDistance.toFixed(4), \"\\n        \\u9EDE\\u534A\\u5F91: \").concat(pointRadius, \", \\u969C\\u7919\\u7269\\u534A\\u5F91: \").concat(obstacleRadius.toFixed(4)));\n        }\n        return isCollision;\n    };\n    DynamicObstacleSystem.prototype.handlePointObstacleCollision = function (point, obstacle) {\n        var dx = point.pos[0] - obstacle.pos[0];\n        var dy = point.pos[1] - obstacle.pos[1];\n        var distance = Math.sqrt(dx * dx + dy * dy);\n        console.log(\"\\u26A1 \\u8655\\u7406\\u78B0\\u649E: \\u8DDD\\u96E2=\".concat(distance.toFixed(4), \", \\u9EDE\\u79FB\\u52D5:[\").concat(point.movement[0].toFixed(3), \", \").concat(point.movement[1].toFixed(3), \"], \\u969C\\u7919\\u7269\\u901F\\u5EA6:[\").concat(obstacle.vel[0].toFixed(3), \", \").concat(obstacle.vel[1].toFixed(3), \"]\"));\n        if (distance === 0)\n            return;\n        var nx = dx / distance;\n        var ny = dy / distance;\n        var relativeVelX = point.movement[0] - obstacle.vel[0];\n        var relativeVelY = point.movement[1] - obstacle.vel[1];\n        var velAlongNormal = relativeVelX * nx + relativeVelY * ny;\n        if (velAlongNormal > 0)\n            return;\n        var pointMass = 0.1;\n        var e = obstacle.restitution;\n        var j = -(1 + e) * velAlongNormal / (1 / pointMass + 1 / obstacle.mass);\n        var impulseX = j * nx;\n        var impulseY = j * ny;\n        obstacle.vel[0] += impulseX / obstacle.mass;\n        obstacle.vel[1] += impulseY / obstacle.mass;\n        var pointRadius = 0.01;\n        var obstacleRadius = (obstacle.size[0] + obstacle.size[1]) * 0.5;\n        var overlap = pointRadius + obstacleRadius - distance;\n        if (overlap > 0) {\n            var separationX = nx * overlap * 0.5;\n            var separationY = ny * overlap * 0.5;\n            obstacle.pos[0] -= separationX;\n            obstacle.pos[1] -= separationY;\n        }\n    };\n    DynamicObstacleSystem.prototype.handleBoundaryCollision = function (obstacle) {\n        var halfSizeX = obstacle.size[0] * 0.5;\n        var halfSizeY = obstacle.size[1] * 0.5;\n        if (obstacle.pos[0] - halfSizeX < 0) {\n            obstacle.pos[0] = halfSizeX;\n            obstacle.vel[0] = -obstacle.vel[0] * obstacle.restitution;\n        }\n        else if (obstacle.pos[0] + halfSizeX > 1) {\n            obstacle.pos[0] = 1 - halfSizeX;\n            obstacle.vel[0] = -obstacle.vel[0] * obstacle.restitution;\n        }\n        if (obstacle.pos[1] - halfSizeY < 0) {\n            obstacle.pos[1] = halfSizeY;\n            obstacle.vel[1] = -obstacle.vel[1] * obstacle.restitution;\n        }\n        else if (obstacle.pos[1] + halfSizeY > 1) {\n            obstacle.pos[1] = 1 - halfSizeY;\n            obstacle.vel[1] = -obstacle.vel[1] * obstacle.restitution;\n        }\n    };\n    DynamicObstacleSystem.prototype.handleObstacleCollisions = function () {\n        for (var i = 0; i < this.obstacles.length; i++) {\n            for (var j = i + 1; j < this.obstacles.length; j++) {\n                var obs1 = this.obstacles[i];\n                var obs2 = this.obstacles[j];\n                var dx = obs2.pos[0] - obs1.pos[0];\n                var dy = obs2.pos[1] - obs1.pos[1];\n                var distance = Math.sqrt(dx * dx + dy * dy);\n                var radius1 = (obs1.size[0] + obs1.size[1]) * 0.5;\n                var radius2 = (obs2.size[0] + obs2.size[1]) * 0.5;\n                var minDistance = radius1 + radius2;\n                if (distance < minDistance && distance > 0) {\n                    var nx = dx / distance;\n                    var ny = dy / distance;\n                    var relativeVelX = obs2.vel[0] - obs1.vel[0];\n                    var relativeVelY = obs2.vel[1] - obs1.vel[1];\n                    var velAlongNormal = relativeVelX * nx + relativeVelY * ny;\n                    if (velAlongNormal > 0)\n                        continue;\n                    var e = Math.min(obs1.restitution, obs2.restitution);\n                    var j_1 = -(1 + e) * velAlongNormal / (1 / obs1.mass + 1 / obs2.mass);\n                    var impulseX = j_1 * nx;\n                    var impulseY = j_1 * ny;\n                    obs1.vel[0] -= impulseX / obs1.mass;\n                    obs1.vel[1] -= impulseY / obs1.mass;\n                    obs2.vel[0] += impulseX / obs2.mass;\n                    obs2.vel[1] += impulseY / obs2.mass;\n                    var overlap = minDistance - distance;\n                    var separationX = nx * overlap * 0.5;\n                    var separationY = ny * overlap * 0.5;\n                    obs1.pos[0] -= separationX;\n                    obs1.pos[1] -= separationY;\n                    obs2.pos[0] += separationX;\n                    obs2.pos[1] += separationY;\n                }\n            }\n        }\n    };\n    DynamicObstacleSystem.prototype.update = function (mousePoints, deltaTime) {\n        for (var _i = 0, mousePoints_1 = mousePoints; _i < mousePoints_1.length; _i++) {\n            var point = mousePoints_1[_i];\n            for (var _a = 0, _b = this.obstacles; _a < _b.length; _a++) {\n                var obstacle = _b[_a];\n                if (this.checkPointObstacleCollision(point, obstacle)) {\n                    console.log(\"\\uD83D\\uDEA8 WS\\u9EDE\\u78B0\\u649E\\u6AA2\\u6E2C\\u6210\\u529F! \\u9EDE\\u4F4D\\u7F6E:[\".concat(point.pos[0].toFixed(3), \", \").concat(point.pos[1].toFixed(3), \"], \\u969C\\u7919\\u7269\\u4F4D\\u7F6E:[\").concat(obstacle.pos[0].toFixed(3), \", \").concat(obstacle.pos[1].toFixed(3), \"], ID:\").concat(obstacle.id));\n                    this.handlePointObstacleCollision(point, obstacle);\n                }\n            }\n        }\n        for (var _c = 0, _d = this.obstacles; _c < _d.length; _c++) {\n            var obstacle = _d[_c];\n            obstacle.vel[0] *= obstacle.friction;\n            obstacle.vel[1] *= obstacle.friction;\n            obstacle.pos[0] += obstacle.vel[0] * deltaTime;\n            obstacle.pos[1] += obstacle.vel[1] * deltaTime;\n            this.handleBoundaryCollision(obstacle);\n        }\n        this.handleObstacleCollisions();\n    };\n    DynamicObstacleSystem.prototype.getObstacles = function () {\n        return this.obstacles;\n    };\n    DynamicObstacleSystem.prototype.removeObstacle = function (id) {\n        this.obstacles = this.obstacles.filter(function (obs) { return obs.id !== id; });\n    };\n    DynamicObstacleSystem.prototype.clear = function () {\n        this.obstacles = [];\n    };\n    DynamicObstacleSystem.prototype.updateCanvasSize = function (width, height) {\n        this.canvasWidth = width;\n        this.canvasHeight = height;\n    };\n    return DynamicObstacleSystem;\n}());\nexports.DynamicObstacleSystem = DynamicObstacleSystem;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar gl_resource_1 = __importDefault(require(\"./gl-utils/gl-resource\"));\nvar fbo_1 = __importDefault(require(\"./gl-utils/fbo\"));\nvar Parameters = __importStar(require(\"./parameters\"));\nvar FluidShaders = __importStar(require(\"./shaders/fluid-shaders\"));\nrequire(\"./page-interface-generated\");\nvar Fluid = (function (_super) {\n    __extends(Fluid, _super);\n    function Fluid(gl, width, height) {\n        var _this = _super.call(this, gl) || this;\n        _this._useFloatTextures = false;\n        _this.viscosity = 0.0002;\n        _this.colorIntensity = 0.033;\n        _this.color = true;\n        _this.reset(width, height);\n        return _this;\n    }\n    Fluid.prototype.freeGLResources = function () {\n        if (this._FBO) {\n            this._FBO.freeGLResources();\n        }\n        this.freeTextures();\n        this.freeShaders();\n    };\n    Fluid.prototype.freeTextures = function () {\n        var gl = _super.prototype.gl.call(this);\n        if (this._velTextures) {\n            gl.deleteTexture(this._velTextures[0]);\n            gl.deleteTexture(this._velTextures[1]);\n        }\n        gl.deleteTexture(this._tmpTexture);\n        gl.deleteTexture(this._pressureTexture);\n        gl.deleteTexture(this._divergenceTexture);\n    };\n    Fluid.prototype.freeShaders = function () {\n        function freeShader(shader) {\n            if (shader) {\n                shader.freeGLResources();\n            }\n        }\n        freeShader(this._drawVelocityShader);\n        freeShader(this._drawPressureShader);\n        freeShader(this._addVelShader);\n        freeShader(this._advectShader);\n        freeShader(this._jacobiPressureShader);\n        freeShader(this._divergenceShader);\n        freeShader(this._substractGradientShader);\n        freeShader(this._obstaclesVelocityShader);\n    };\n    Fluid.prototype.reset = function (width, height) {\n        this.freeGLResources();\n        this._width = width;\n        this._height = height;\n        this.dx = 1 / Math.min(width, height);\n        this._FBO = new fbo_1.default(_super.prototype.gl.call(this), width, height);\n        this.initTextures();\n        this.buildShaders();\n        this._currIndex = 0;\n    };\n    Object.defineProperty(Fluid.prototype, \"useFloatTextures\", {\n        set: function (bool) {\n            if (bool !== this._useFloatTextures) {\n                this._useFloatTextures = bool;\n                this.reset(this._width, this._height);\n            }\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Fluid.prototype, \"minNbIterations\", {\n        set: function (value) {\n            this._nbIterations = 2 * Math.ceil(value / 2) + 1;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Fluid.prototype, \"texelSize\", {\n        get: function () {\n            return [1 / this._width, 1 / this._height];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Fluid.prototype, \"velTexture\", {\n        get: function () {\n            return this._velTextures[this.currIndex];\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Fluid.prototype.update = function (obstacleMap) {\n        var gl = _super.prototype.gl.call(this);\n        var dt = this.timestep;\n        gl.clearColor(0.5, 0, 0.5, 0);\n        var multiPoints = window.multiMousePoints || [];\n        var canvas = gl.canvas;\n        var canvasSize = [canvas.clientWidth, canvas.clientHeight];\n        var brushSize = [\n            Parameters.brush.radius / canvasSize[0],\n            Parameters.brush.radius / canvasSize[1]\n        ];\n        for (var _i = 0, multiPoints_1 = multiPoints; _i < multiPoints_1.length; _i++) {\n            var pt = multiPoints_1[_i];\n            var pos = pt.pos;\n            var vel = [\n                pt.movement[0] * Parameters.brush.strength,\n                pt.movement[1] * Parameters.brush.strength,\n            ];\n            this.addVel(pos, brushSize, vel);\n        }\n        this.advect(dt);\n        this.obstaclesVelocity(obstacleMap);\n        this.project(obstacleMap);\n        this.obstaclesVelocity(obstacleMap);\n    };\n    Fluid.prototype.addVel = function (pos, size, vel) {\n        var gl = this.gl();\n        var addVelShader = this._addVelShader;\n        addVelShader.u[\"uVel\"].value = this._velTextures[this.currIndex];\n        addVelShader.u[\"uBrushPos\"].value = pos;\n        addVelShader.u[\"uBrushSize\"].value = size;\n        addVelShader.u[\"uAddVel\"].value = vel;\n        addVelShader.use();\n        this._FBO.bind([this._velTextures[this.nextIndex]]);\n        addVelShader.bindUniformsAndAttributes();\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n        this.switchBuffers();\n    };\n    Fluid.prototype.drawVelocity = function () {\n        var gl = this.gl();\n        var drawShader = this._drawVelocityShader;\n        drawShader.u[\"uVel\"].value = this._velTextures[this.currIndex];\n        drawShader.u[\"uColorIntensity\"].value = this.colorIntensity;\n        drawShader.u[\"uBlacknWhite\"].value = !this.color;\n        drawShader.use();\n        drawShader.bindUniformsAndAttributes();\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    };\n    Fluid.prototype.drawPressure = function () {\n        var gl = this.gl();\n        var drawPressureShader = this._drawPressureShader;\n        drawPressureShader.u[\"uPressure\"].value = this._pressureTexture;\n        drawPressureShader.u[\"uColorIntensity\"].value = this.colorIntensity;\n        drawPressureShader.u[\"uBlacknWhite\"].value = !this.color;\n        drawPressureShader.use();\n        drawPressureShader.bindUniformsAndAttributes();\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    };\n    Object.defineProperty(Fluid.prototype, \"currIndex\", {\n        get: function () {\n            return this._currIndex;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Fluid.prototype, \"nextIndex\", {\n        get: function () {\n            return (this._currIndex + 1) % 2;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Fluid.prototype.switchBuffers = function () {\n        this._currIndex = this.nextIndex;\n    };\n    Fluid.prototype.obstaclesVelocity = function (obstacleMap) {\n        var gl = this.gl();\n        var obstacleVelocityShader = this._obstaclesVelocityShader;\n        obstacleVelocityShader.u[\"uVelocities\"].value = this._velTextures[this.currIndex];\n        obstacleVelocityShader.u[\"uObstacles\"].value = obstacleMap.texture;\n        obstacleVelocityShader.u[\"uTexelSize\"].value = this.texelSize;\n        this._FBO.bind([this._velTextures[this.nextIndex]]);\n        obstacleVelocityShader.use();\n        obstacleVelocityShader.bindUniformsAndAttributes();\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n        this.switchBuffers();\n    };\n    Fluid.prototype.advect = function (dt) {\n        var gl = this.gl();\n        var advectShader = this._advectShader;\n        advectShader.u[\"uVelUnit\"].value = [128 / this._width, 128 / this._height];\n        advectShader.u[\"uDt\"].value = dt;\n        advectShader.u[\"uQuantity\"].value = this._velTextures[this.currIndex];\n        advectShader.u[\"uVel\"].value = this._velTextures[this.currIndex];\n        this._FBO.bind([this._velTextures[this.nextIndex]]);\n        advectShader.use();\n        advectShader.bindUniformsAndAttributes();\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n        this.switchBuffers();\n    };\n    Fluid.prototype.computeDivergence = function () {\n        var gl = this.gl();\n        var divergenceShader = this._divergenceShader;\n        divergenceShader.u[\"uTexelSize\"].value = this.texelSize;\n        divergenceShader.u[\"uVelocity\"].value = this._velTextures[this.currIndex];\n        this._FBO.bind([this._divergenceTexture]);\n        gl.clear(gl.COLOR_BUFFER_BIT);\n        divergenceShader.use();\n        divergenceShader.bindUniformsAndAttributes();\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    };\n    Fluid.prototype.computePressure = function (obstacleMap) {\n        var gl = this.gl();\n        var jacobiPressureShader = this._jacobiPressureShader;\n        var alpha = -.5 * this.dx;\n        var beta = 4;\n        var dst = this._pressureTexture;\n        var cstTerm = this._divergenceTexture;\n        jacobiPressureShader.u[\"uTexelSize\"].value = this.texelSize;\n        jacobiPressureShader.u[\"uAlpha\"].value = alpha;\n        jacobiPressureShader.u[\"uInvBeta\"].value = 1 / beta;\n        jacobiPressureShader.u[\"uConstantTerm\"].value = cstTerm;\n        jacobiPressureShader.u[\"uObstacles\"].value = obstacleMap.texture;\n        var index = 0;\n        var textures = [this._tmpTexture, dst];\n        this._FBO.bind([this._tmpTexture]);\n        gl.clear(gl.COLOR_BUFFER_BIT);\n        jacobiPressureShader.use();\n        jacobiPressureShader.bindAttributes();\n        for (var i = 0; i < this._nbIterations; ++i) {\n            jacobiPressureShader.u[\"uPrevIter\"].value = textures[index];\n            this._FBO.bind([textures[(index + 1) % 2]]);\n            jacobiPressureShader.bindUniforms();\n            gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n            index = (index + 1) % 2;\n        }\n    };\n    Fluid.prototype.substractPressureGradient = function () {\n        var gl = this.gl();\n        var substractGradientShader = this._substractGradientShader;\n        substractGradientShader.u[\"uVelocities\"].value = this._velTextures[this.currIndex];\n        substractGradientShader.u[\"uPressure\"].value = this._pressureTexture;\n        substractGradientShader.u[\"uTexelSize\"].value = this.texelSize;\n        substractGradientShader.u[\"uHalfInvDx\"].value = 0.5 / this.dx;\n        this._FBO.bind([this._velTextures[this.nextIndex]]);\n        substractGradientShader.use();\n        substractGradientShader.bindUniformsAndAttributes();\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n        this.switchBuffers();\n    };\n    Fluid.prototype.project = function (obstacleMap) {\n        this.computeDivergence();\n        this.computePressure(obstacleMap);\n        this.substractPressureGradient();\n    };\n    Fluid.prototype.initTextures = function () {\n        this.freeTextures();\n        var gl = _super.prototype.gl.call(this);\n        var width = this._width;\n        var height = this._height;\n        var floatTexels = [];\n        for (var i = 0; i < 4 * width * height; ++i) {\n            floatTexels.push(0);\n        }\n        var floatData = new Float32Array(floatTexels);\n        var uintTexels = [];\n        for (var i = 0; i < 4 * width * height; ++i) {\n            uintTexels.push(127);\n        }\n        var uintData = new Uint8Array(uintTexels);\n        var velFormat = (this._useFloatTextures) ? gl.FLOAT : gl.UNSIGNED_BYTE;\n        var velData = (this._useFloatTextures) ? floatData : uintData;\n        var textures = [];\n        for (var i = 0; i < 2; ++i) {\n            var texture = gl.createTexture();\n            gl.bindTexture(gl.TEXTURE_2D, texture);\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, velFormat, velData);\n            textures.push(texture);\n        }\n        for (var i = 0; i < 3; ++i) {\n            var texture = gl.createTexture();\n            gl.bindTexture(gl.TEXTURE_2D, texture);\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, uintData);\n            textures.push(texture);\n        }\n        for (var _i = 0, textures_1 = textures; _i < textures_1.length; _i++) {\n            var texture = textures_1[_i];\n            gl.bindTexture(gl.TEXTURE_2D, texture);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        }\n        gl.bindTexture(gl.TEXTURE_2D, null);\n        this._velTextures = [textures[0], textures[1]];\n        this._tmpTexture = textures[2];\n        this._pressureTexture = textures[3];\n        this._divergenceTexture = textures[4];\n    };\n    Fluid.prototype.buildShaders = function () {\n        this.freeShaders();\n        FluidShaders.setUseFloatTextures(this._useFloatTextures);\n        var gl = _super.prototype.gl.call(this);\n        this._drawVelocityShader = FluidShaders.buildDrawVelocityShader(gl);\n        this._drawPressureShader = FluidShaders.buildDrawPressureShader(gl);\n        this._addVelShader = FluidShaders.buildAddVelShader(gl);\n        this._advectShader = FluidShaders.buildAdvectShader(gl);\n        this._jacobiPressureShader = FluidShaders.buildJacobiPressureShader(gl);\n        this._divergenceShader = FluidShaders.buildDivergenceShader(gl);\n        this._substractGradientShader = FluidShaders.buildSubstractGradientShader(gl);\n        this._obstaclesVelocityShader = FluidShaders.buildObstaclesVelocityShader(gl);\n    };\n    return Fluid;\n}(gl_resource_1.default));\nexports.default = Fluid;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar gl_resource_1 = __importDefault(require(\"./gl-resource\"));\nvar FBO = (function (_super) {\n    __extends(FBO, _super);\n    function FBO(gl, width, height) {\n        var _this = _super.call(this, gl) || this;\n        _this.id = gl.createFramebuffer();\n        _this.width = width;\n        _this.height = height;\n        return _this;\n    }\n    FBO.prototype.bind = function (colorBuffers, depthBuffer) {\n        if (depthBuffer === void 0) { depthBuffer = null; }\n        var gl = _super.prototype.gl.call(this);\n        gl.bindFramebuffer(gl.FRAMEBUFFER, this.id);\n        gl.viewport(0, 0, this.width, this.height);\n        for (var i = 0; i < colorBuffers.length; ++i) {\n            gl.framebufferTexture2D(gl.FRAMEBUFFER, gl['COLOR_ATTACHMENT' + i], gl.TEXTURE_2D, colorBuffers[i], 0);\n        }\n        if (depthBuffer) {\n            gl.bindRenderbuffer(gl.RENDERBUFFER, depthBuffer);\n            gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, depthBuffer);\n        }\n    };\n    FBO.bindDefault = function (gl) {\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n        gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);\n    };\n    FBO.prototype.freeGLResources = function () {\n        _super.prototype.gl.call(this).deleteFramebuffer(this.id);\n        this.id = null;\n    };\n    return FBO;\n}(gl_resource_1.default));\nexports.default = FBO;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar GLResource = (function () {\n    function GLResource(gl) {\n        this._gl = gl;\n    }\n    GLResource.prototype.gl = function () {\n        return this._gl;\n    };\n    return GLResource;\n}());\nexports.default = GLResource;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar gl_resource_1 = __importDefault(require(\"./gl-resource\"));\nfunction notImplemented(gl, location, value) {\n    alert(\"NOT IMPLEMENTED YET\");\n}\nfunction bindUniformFloat(gl, location, value) {\n    if (Array.isArray(value)) {\n        gl.uniform1fv(location, value);\n    }\n    else {\n        gl.uniform1f(location, value);\n    }\n}\nfunction bindUniformFloat2v(gl, location, value) {\n    gl.uniform2fv(location, value);\n}\nfunction bindUniformFloat3v(gl, location, value) {\n    gl.uniform3fv(location, value);\n}\nfunction bindUniformFloat4v(gl, location, value) {\n    gl.uniform4fv(location, value);\n}\nfunction bindUniformInt(gl, location, value) {\n    if (Array.isArray(value)) {\n        gl.uniform1iv(location, value);\n    }\n    else {\n        gl.uniform1iv(location, value);\n    }\n}\nfunction bindUniformInt2v(gl, location, value) {\n    gl.uniform2iv(location, value);\n}\nfunction bindUniformInt3v(gl, location, value) {\n    gl.uniform3iv(location, value);\n}\nfunction bindUniformInt4v(gl, location, value) {\n    gl.uniform4iv(location, value);\n}\nfunction bindUniformBool(gl, location, value) {\n    gl.uniform1i(location, +value);\n}\nfunction bindUniformBool2v(gl, location, value) {\n    gl.uniform2iv(location, value);\n}\nfunction bindUniformBool3v(gl, location, value) {\n    gl.uniform3iv(location, value);\n}\nfunction bindUniformBool4v(gl, location, value) {\n    gl.uniform4iv(location, value);\n}\nfunction bindUniformFloatMat2(gl, location, value) {\n    gl.uniformMatrix2fv(location, false, value);\n}\nfunction bindUniformFloatMat3(gl, location, value) {\n    gl.uniformMatrix3fv(location, false, value);\n}\nfunction bindUniformFloatMat4(gl, location, value) {\n    gl.uniformMatrix4fv(location, false, value);\n}\nfunction bindSampler2D(gl, location, unitNb, value) {\n    gl.uniform1i(location, unitNb);\n    gl.activeTexture(gl['TEXTURE' + unitNb]);\n    gl.bindTexture(gl.TEXTURE_2D, value);\n}\nfunction bindSamplerCube(gl, location, unitNb, value) {\n    gl.uniform1i(location, unitNb);\n    gl.activeTexture(gl['TEXTURE' + unitNb]);\n    gl.bindTexture(gl.TEXTURE_CUBE_MAP, value);\n}\n;\nvar types = {\n    0x8B50: { str: 'FLOAT_VEC2', binder: bindUniformFloat2v },\n    0x8B51: { str: 'FLOAT_VEC3', binder: bindUniformFloat3v },\n    0x8B52: { str: 'FLOAT_VEC4', binder: bindUniformFloat4v },\n    0x8B53: { str: 'INT_VEC2', binder: bindUniformInt2v },\n    0x8B54: { str: 'INT_VEC3', binder: bindUniformInt3v },\n    0x8B55: { str: 'INT_VEC4', binder: bindUniformInt4v },\n    0x8B56: { str: 'BOOL', binder: bindUniformBool },\n    0x8B57: { str: 'BOOL_VEC2', binder: bindUniformBool2v },\n    0x8B58: { str: 'BOOL_VEC3', binder: bindUniformBool3v },\n    0x8B59: { str: 'BOOL_VEC4', binder: bindUniformBool4v },\n    0x8B5A: { str: 'FLOAT_MAT2', binder: bindUniformFloatMat2 },\n    0x8B5B: { str: 'FLOAT_MAT3', binder: bindUniformFloatMat3 },\n    0x8B5C: { str: 'FLOAT_MAT4', binder: bindUniformFloatMat4 },\n    0x8B5E: { str: 'SAMPLER_2D', binder: bindSampler2D },\n    0x8B60: { str: 'SAMPLER_CUBE', binder: bindSamplerCube },\n    0x1400: { str: 'BYTE', binder: notImplemented },\n    0x1401: { str: 'UNSIGNED_BYTE', binder: notImplemented },\n    0x1402: { str: 'SHORT', binder: notImplemented },\n    0x1403: { str: 'UNSIGNED_SHORT', binder: notImplemented },\n    0x1404: { str: 'INT', binder: bindUniformInt },\n    0x1405: { str: 'UNSIGNED_INT', binder: notImplemented },\n    0x1406: { str: 'FLOAT', binder: bindUniformFloat }\n};\nvar ShaderProgram = (function (_super) {\n    __extends(ShaderProgram, _super);\n    function ShaderProgram(gl, vertexSource, fragmentSource) {\n        var _this = this;\n        function createShader(type, source) {\n            var shader = gl.createShader(type);\n            gl.shaderSource(shader, source);\n            gl.compileShader(shader);\n            var success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n            if (!success) {\n                console.log(gl.getShaderInfoLog(shader));\n                gl.deleteShader(shader);\n                return null;\n            }\n            return shader;\n        }\n        _this = _super.call(this, gl) || this;\n        _this.id = null;\n        _this.uCount = 0;\n        _this.aCount = 0;\n        var vertexShader = createShader(gl.VERTEX_SHADER, vertexSource);\n        var fragmentShader = createShader(gl.FRAGMENT_SHADER, fragmentSource);\n        var id = gl.createProgram();\n        gl.attachShader(id, vertexShader);\n        gl.attachShader(id, fragmentShader);\n        gl.linkProgram(id);\n        var success = gl.getProgramParameter(id, gl.LINK_STATUS);\n        if (!success) {\n            console.log(gl.getProgramInfoLog(id));\n            gl.deleteProgram(id);\n        }\n        else {\n            _this.id = id;\n            _this.introspection();\n        }\n        return _this;\n    }\n    ShaderProgram.prototype.freeGLResources = function () {\n        _super.prototype.gl.call(this).deleteProgram(this.id);\n        this.id = null;\n    };\n    ShaderProgram.prototype.introspection = function () {\n        var gl = _super.prototype.gl.call(this);\n        this.uCount = gl.getProgramParameter(this.id, gl.ACTIVE_UNIFORMS);\n        this.u = [];\n        for (var i = 0; i < this.uCount; ++i) {\n            var uniform = gl.getActiveUniform(this.id, i);\n            var name_1 = uniform.name;\n            this.u[name_1] = {\n                value: null,\n                loc: gl.getUniformLocation(this.id, name_1),\n                size: uniform.size,\n                type: uniform.type,\n            };\n        }\n        this.aCount = gl.getProgramParameter(this.id, gl.ACTIVE_ATTRIBUTES);\n        this.a = [];\n        for (var i = 0; i < this.aCount; ++i) {\n            var attribute = gl.getActiveAttrib(this.id, i);\n            var name_2 = attribute.name;\n            this.a[name_2] = {\n                VBO: null,\n                loc: gl.getAttribLocation(this.id, name_2),\n                size: attribute.size,\n                type: attribute.type,\n            };\n        }\n    };\n    ShaderProgram.prototype.use = function () {\n        _super.prototype.gl.call(this).useProgram(this.id);\n    };\n    ShaderProgram.prototype.bindUniforms = function () {\n        var gl = _super.prototype.gl.call(this);\n        var currTextureUnitNb = 0;\n        for (var uName in this.u) {\n            var uniform = this.u[uName];\n            if (uniform.value !== null) {\n                if (uniform.type === 0x8B5E || uniform.type === 0x8B60) {\n                    var unitNb = currTextureUnitNb;\n                    types[uniform.type].binder(gl, uniform.loc, unitNb, uniform.value);\n                    currTextureUnitNb++;\n                }\n                else {\n                    types[uniform.type].binder(gl, uniform.loc, uniform.value);\n                }\n            }\n        }\n    };\n    ShaderProgram.prototype.bindAttributes = function () {\n        for (var aName in this.a) {\n            var attribute = this.a[aName];\n            if (attribute.VBO !== null) {\n                attribute.VBO.bind(attribute.loc);\n            }\n        }\n    };\n    ShaderProgram.prototype.bindUniformsAndAttributes = function () {\n        this.bindUniforms();\n        this.bindAttributes();\n    };\n    return ShaderProgram;\n}(gl_resource_1.default));\nexports.default = ShaderProgram;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.resizeCanvas = void 0;\nfunction resizeCanvas(gl, hidpi) {\n    if (hidpi === void 0) { hidpi = false; }\n    var cssPixel = (hidpi) ? window.devicePixelRatio : 1;\n    var canvas = gl.canvas;\n    var width = Math.floor(canvas.clientWidth * cssPixel);\n    var height = Math.floor(canvas.clientHeight * cssPixel);\n    if (canvas.width != width || canvas.height != height) {\n        canvas.width = width;\n        canvas.height = height;\n    }\n}\nexports.resizeCanvas = resizeCanvas;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar gl_resource_1 = __importDefault(require(\"./gl-resource\"));\nvar VBO = (function (_super) {\n    __extends(VBO, _super);\n    function VBO(gl, array, size, type) {\n        var _this = _super.call(this, gl) || this;\n        _this.id = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, _this.id);\n        gl.bufferData(gl.ARRAY_BUFFER, array, gl.STATIC_DRAW);\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\n        _this.size = size;\n        _this.type = type;\n        _this.normalize = false;\n        _this.stride = 0;\n        _this.offset = 0;\n        return _this;\n    }\n    VBO.prototype.freeGLResources = function () {\n        this.gl().deleteBuffer(this.id);\n        this.id = null;\n    };\n    VBO.createQuad = function (gl, minX, minY, maxX, maxY) {\n        var vert = [\n            minX, minY,\n            maxX, minY,\n            minX, maxY,\n            maxX, maxY,\n        ];\n        return new VBO(gl, new Float32Array(vert), 2, gl.FLOAT);\n    };\n    VBO.prototype.bind = function (location) {\n        var gl = _super.prototype.gl.call(this);\n        gl.enableVertexAttribArray(location);\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.id);\n        gl.vertexAttribPointer(location, this.size, this.type, this.normalize, this.stride, this.offset);\n    };\n    return VBO;\n}(gl_resource_1.default));\n;\nexports.default = VBO;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar Utils = __importStar(require(\"./gl-utils/utils\"));\nvar fbo_1 = __importDefault(require(\"./gl-utils/fbo\"));\nvar Parameters = __importStar(require(\"./parameters\"));\nvar brush_1 = __importDefault(require(\"./brush\"));\nvar obstacle_map_1 = __importDefault(require(\"./obstacle-map\"));\nvar fluid_1 = __importDefault(require(\"./fluid\"));\nvar Requirements = __importStar(require(\"./requirements\"));\nrequire(\"./page-interface-generated\");\nvar ws_mouse_1 = require(\"./ws-mouse\");\nvar mouse_point_renderer_1 = require(\"./mouse-point-renderer\");\nvar dynamic_obstacle_controller_1 = require(\"./dynamic-obstacle-controller\");\nvar mousePointRenderer = null;\nvar dynamicObstacleController = null;\nfunction updateFluidWithMultiMouse(points) {\n    window.multiMousePoints = points;\n    if (mousePointRenderer) {\n        mousePointRenderer.updatePoints(points);\n    }\n}\nvar ws = new ws_mouse_1.MultiMouseWS(\"ws://localhost:9980\", updateFluidWithMultiMouse, 10);\nws.connect();\nfunction initGL(canvas, flags) {\n    function setError(message) {\n        Page.Demopage.setErrorMessage(\"webgl-support\", message);\n    }\n    var gl = canvas.getContext(\"webgl\", flags);\n    if (!gl) {\n        gl = canvas.getContext(\"experimental-webgl\", flags);\n        if (!gl) {\n            setError(\"Your browser or device does not seem to support WebGL.\");\n            return null;\n        }\n        setError(\"Your browser or device only supports experimental WebGL.\\n\" +\n            \"The simulation may not run as expected.\");\n    }\n    if (gl) {\n        canvas.style.cursor = \"none\";\n        gl.disable(gl.CULL_FACE);\n        gl.disable(gl.DEPTH_TEST);\n        gl.disable(gl.BLEND);\n        gl.clearColor(0.0, 0.0, 0.0, 1.0);\n        Utils.resizeCanvas(gl, false);\n    }\n    return gl;\n}\nfunction main() {\n    var canvas = Page.Canvas.getCanvas();\n    if (!canvas) {\n        console.error(\"Canvas element not found\");\n        return;\n    }\n    var gl = initGL(canvas, { alpha: false });\n    if (!gl || !Requirements.check(gl))\n        return;\n    var webgl = gl;\n    mousePointRenderer = new mouse_point_renderer_1.MousePointRenderer(canvas);\n    var extensions = [\n        \"OES_texture_float\",\n        \"WEBGL_color_buffer_float\",\n        \"OES_texture_float_linear\",\n    ];\n    Requirements.loadExtensions(webgl, extensions);\n    var size = 256;\n    var fluid = new fluid_1.default(webgl, size, size);\n    var brush = new brush_1.default(webgl);\n    var obstacleMaps = [];\n    obstacleMaps[\"none\"] = new obstacle_map_1.default(webgl, size, size);\n    obstacleMaps[\"one\"] = new obstacle_map_1.default(webgl, size, size);\n    {\n        obstacleMaps[\"one\"].addObstacle([0.015, 0.015], [0.3, 0.5]);\n    }\n    obstacleMaps[\"many\"] = new obstacle_map_1.default(webgl, size, size);\n    {\n        var size_1 = [0.012, 0.012];\n        for (var iX = 0; iX < 5; ++iX) {\n            for (var iY = -iX / 2; iY <= iX / 2; ++iY) {\n                size_1 = [size_1[0] + 0.0005, size_1[1] + 0.0005];\n                var pos = [0.3 + iX * 0.07, 0.5 + iY * 0.08];\n                obstacleMaps[\"many\"].addObstacle(size_1, pos);\n            }\n        }\n    }\n    obstacleMaps[\"dynamic\"] = new obstacle_map_1.default(webgl, size, size);\n    dynamicObstacleController = new dynamic_obstacle_controller_1.DynamicObstacleController(obstacleMaps[\"dynamic\"], mousePointRenderer);\n    Parameters.bind(fluid);\n    var instantFPS = 0;\n    var updateFpsText = function () {\n        Page.Canvas.setIndicatorText(\"fps\", instantFPS.toFixed(0));\n    };\n    setInterval(updateFpsText, 1000);\n    var lastUpdate = 0;\n    function mainLoop(time) {\n        time *= 0.001;\n        var dt = time - lastUpdate;\n        instantFPS = 1 / dt;\n        lastUpdate = time;\n        dt = Math.min(dt, 1 / 10);\n        var obstacleMap = obstacleMaps[Parameters.obstacles];\n        if (dynamicObstacleController && Parameters.obstacles === \"dynamic\") {\n            var multiMousePoints = window.multiMousePoints || [];\n            var obstacleCount = obstacleMaps[\"dynamic\"].getDynamicObstacles().length;\n            if (multiMousePoints.length > 0) {\n                console.log(\"\\uD83C\\uDFAF \\u66F4\\u65B0\\u52D5\\u614B\\u969C\\u7919\\u7269: \\u6536\\u5230\".concat(multiMousePoints.length, \"\\u500BWS\\u9EDE, \\u7576\\u524D\\u6709\").concat(obstacleCount, \"\\u500B\\u969C\\u7919\\u7269\"));\n                multiMousePoints.forEach(function (point, index) {\n                    console.log(\"  \\u9EDE\".concat(index, \": \\u4F4D\\u7F6E[\").concat(point.pos[0].toFixed(3), \", \").concat(point.pos[1].toFixed(3), \"], \\u79FB\\u52D5[\").concat(point.movement[0].toFixed(3), \", \").concat(point.movement[1].toFixed(3), \"]\"));\n                });\n                var obstacles = obstacleMaps[\"dynamic\"].getDynamicObstacles();\n                obstacles.forEach(function (obs, index) {\n                    console.log(\"  \\u969C\\u7919\\u7269\".concat(index, \" (ID:\").concat(obs.id, \"): \\u4F4D\\u7F6E[\").concat(obs.pos[0].toFixed(3), \", \").concat(obs.pos[1].toFixed(3), \"], \\u5927\\u5C0F[\").concat(obs.size[0].toFixed(3), \", \").concat(obs.size[1].toFixed(3), \"], \\u901F\\u5EA6[\").concat(obs.vel[0].toFixed(3), \", \").concat(obs.vel[1].toFixed(3), \"]\"));\n                });\n            }\n            dynamicObstacleController.update(multiMousePoints, dt);\n            obstacleMap.addDynamicObstacleVelocityToFluid(fluid);\n        }\n        if (Parameters.fluid.stream) {\n            fluid.addVel([0.1, 0.5], [0.05, 0.2], [0.4, 0]);\n        }\n        fluid.update(obstacleMap);\n        fbo_1.default.bindDefault(webgl);\n        webgl.clear(webgl.COLOR_BUFFER_BIT | webgl.DEPTH_BUFFER_BIT);\n        if (Parameters.display.velocity) {\n            fluid.drawVelocity();\n        }\n        else if (Parameters.display.pressure) {\n            fluid.drawPressure();\n        }\n        if (Parameters.display.brush) {\n            brush.draw();\n        }\n        if (Parameters.display.obstacles) {\n            obstacleMap.draw();\n        }\n        if (Parameters.display.velocity && Parameters.display.pressure) {\n            webgl.viewport(10, 10, 128, 128);\n            fluid.drawPressure();\n        }\n        requestAnimationFrame(mainLoop);\n    }\n    requestAnimationFrame(mainLoop);\n}\nmain();\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MousePointRenderer = void 0;\nvar MousePointRenderer = (function () {\n    function MousePointRenderer(targetCanvas) {\n        var _this = this;\n        this.points = [];\n        this.dynamicObstacles = [];\n        this.canvas = targetCanvas;\n        this.overlayCanvas = document.createElement('canvas');\n        this.overlayCanvas.style.position = 'absolute';\n        this.overlayCanvas.style.top = '0';\n        this.overlayCanvas.style.left = '0';\n        this.overlayCanvas.style.pointerEvents = 'none';\n        this.overlayCanvas.style.zIndex = '10';\n        this.updateCanvasSize();\n        if (this.canvas.parentElement) {\n            this.canvas.parentElement.appendChild(this.overlayCanvas);\n            if (getComputedStyle(this.canvas.parentElement).position === 'static') {\n                this.canvas.parentElement.style.position = 'relative';\n            }\n        }\n        this.overlayCtx = this.overlayCanvas.getContext('2d');\n        var resizeObserver = new ResizeObserver(function () {\n            _this.updateCanvasSize();\n        });\n        resizeObserver.observe(this.canvas);\n    }\n    MousePointRenderer.prototype.updateCanvasSize = function () {\n        var rect = this.canvas.getBoundingClientRect();\n        this.overlayCanvas.width = rect.width;\n        this.overlayCanvas.height = rect.height;\n        this.overlayCanvas.style.width = rect.width + 'px';\n        this.overlayCanvas.style.height = rect.height + 'px';\n    };\n    MousePointRenderer.prototype.updatePoints = function (points) {\n        this.points = points;\n        this.render();\n    };\n    MousePointRenderer.prototype.updateDynamicObstacles = function (obstacles) {\n        this.dynamicObstacles = obstacles;\n        this.render();\n    };\n    MousePointRenderer.prototype.render = function () {\n        var _this = this;\n        this.overlayCtx.clearRect(0, 0, this.overlayCanvas.width, this.overlayCanvas.height);\n        var canvasWidth = this.overlayCanvas.width;\n        var canvasHeight = this.overlayCanvas.height;\n        this.renderDynamicObstacles(canvasWidth, canvasHeight);\n        if (this.points.length === 0)\n            return;\n        this.points.forEach(function (point, index) {\n            var x = point.pos[0] * canvasWidth;\n            var y = (1.0 - point.pos[1]) * canvasHeight;\n            var hue = (index * 137.5) % 360;\n            var color = \"hsl(\".concat(hue, \", 70%, 60%)\");\n            _this.drawPoint(x, y, color, index);\n            if (point.movement[0] !== 0 || point.movement[1] !== 0) {\n                _this.drawMovement(x, y, point.movement, color, canvasWidth, canvasHeight);\n            }\n        });\n    };\n    MousePointRenderer.prototype.renderDynamicObstacles = function (canvasWidth, canvasHeight) {\n        var _this = this;\n        this.dynamicObstacles.forEach(function (obstacle, index) {\n            var x = obstacle.pos[0] * canvasWidth;\n            var y = (1.0 - obstacle.pos[1]) * canvasHeight;\n            var sizeX = obstacle.size[0] * canvasWidth;\n            var sizeY = obstacle.size[1] * canvasHeight;\n            _this.drawObstacle(x, y, sizeX, sizeY, obstacle, index);\n            if (obstacle.vel[0] !== 0 || obstacle.vel[1] !== 0) {\n                _this.drawObstacleVelocity(x, y, obstacle.vel, canvasWidth, canvasHeight);\n            }\n        });\n    };\n    MousePointRenderer.prototype.drawPoint = function (x, y, color, index) {\n        var ctx = this.overlayCtx;\n        ctx.beginPath();\n        ctx.arc(x, y, 12, 0, 2 * Math.PI);\n        ctx.fillStyle = color;\n        ctx.globalAlpha = 0.7;\n        ctx.fill();\n        ctx.beginPath();\n        ctx.arc(x, y, 8, 0, 2 * Math.PI);\n        ctx.fillStyle = 'white';\n        ctx.globalAlpha = 0.9;\n        ctx.fill();\n        ctx.fillStyle = 'black';\n        ctx.globalAlpha = 1.0;\n        ctx.font = '12px Arial';\n        ctx.textAlign = 'center';\n        ctx.textBaseline = 'middle';\n        ctx.fillText((index + 1).toString(), x, y);\n        ctx.globalAlpha = 1.0;\n    };\n    MousePointRenderer.prototype.drawMovement = function (x, y, movement, color, canvasWidth, canvasHeight) {\n        var ctx = this.overlayCtx;\n        var moveX = movement[0] * canvasWidth * 100;\n        var moveY = movement[1] * canvasHeight * 100;\n        var magnitude = Math.sqrt(moveX * moveX + moveY * moveY);\n        if (magnitude < 5)\n            return;\n        var endX = x + moveX;\n        var endY = y + moveY;\n        ctx.beginPath();\n        ctx.moveTo(x, y);\n        ctx.lineTo(endX, endY);\n        ctx.strokeStyle = color;\n        ctx.lineWidth = 2;\n        ctx.globalAlpha = 0.8;\n        ctx.stroke();\n        var angle = Math.atan2(moveY, moveX);\n        var headLength = Math.min(15, magnitude * 0.3);\n        ctx.beginPath();\n        ctx.moveTo(endX, endY);\n        ctx.lineTo(endX - headLength * Math.cos(angle - Math.PI / 6), endY - headLength * Math.sin(angle - Math.PI / 6));\n        ctx.moveTo(endX, endY);\n        ctx.lineTo(endX - headLength * Math.cos(angle + Math.PI / 6), endY - headLength * Math.sin(angle + Math.PI / 6));\n        ctx.stroke();\n        ctx.globalAlpha = 1.0;\n    };\n    MousePointRenderer.prototype.drawObstacle = function (x, y, sizeX, sizeY, obstacle, index) {\n        var ctx = this.overlayCtx;\n        var hue = (obstacle.mass * 60 + obstacle.friction * 120) % 360;\n        var color = \"hsl(\".concat(hue, \", 80%, 50%)\");\n        ctx.beginPath();\n        ctx.ellipse(x, y, sizeX / 2, sizeY / 2, 0, 0, 2 * Math.PI);\n        ctx.fillStyle = color;\n        ctx.globalAlpha = 0.8;\n        ctx.fill();\n        ctx.strokeStyle = 'white';\n        ctx.lineWidth = 2;\n        ctx.globalAlpha = 1.0;\n        ctx.stroke();\n        ctx.fillStyle = 'white';\n        ctx.font = '10px Arial';\n        ctx.textAlign = 'center';\n        ctx.textBaseline = 'middle';\n        ctx.fillText(\"O\".concat(obstacle.id), x, y);\n        ctx.font = '8px Arial';\n        ctx.fillStyle = 'black';\n        ctx.fillText(\"M:\".concat(obstacle.mass.toFixed(1), \" F:\").concat(obstacle.friction.toFixed(2), \" R:\").concat(obstacle.restitution.toFixed(2)), x, y + sizeY / 2 + 10);\n    };\n    MousePointRenderer.prototype.drawObstacleVelocity = function (x, y, velocity, canvasWidth, canvasHeight) {\n        var ctx = this.overlayCtx;\n        var velX = velocity[0] * canvasWidth * 200;\n        var velY = -velocity[1] * canvasHeight * 200;\n        var magnitude = Math.sqrt(velX * velX + velY * velY);\n        if (magnitude < 3)\n            return;\n        var endX = x + velX;\n        var endY = y + velY;\n        ctx.beginPath();\n        ctx.moveTo(x, y);\n        ctx.lineTo(endX, endY);\n        ctx.strokeStyle = 'red';\n        ctx.lineWidth = 2;\n        ctx.globalAlpha = 0.9;\n        ctx.stroke();\n        var angle = Math.atan2(velY, velX);\n        var headLength = Math.min(12, magnitude * 0.2);\n        ctx.beginPath();\n        ctx.moveTo(endX, endY);\n        ctx.lineTo(endX - headLength * Math.cos(angle - Math.PI / 6), endY - headLength * Math.sin(angle - Math.PI / 6));\n        ctx.moveTo(endX, endY);\n        ctx.lineTo(endX - headLength * Math.cos(angle + Math.PI / 6), endY - headLength * Math.sin(angle + Math.PI / 6));\n        ctx.stroke();\n        ctx.globalAlpha = 1.0;\n    };\n    MousePointRenderer.prototype.destroy = function () {\n        if (this.overlayCanvas.parentElement) {\n            this.overlayCanvas.parentElement.removeChild(this.overlayCanvas);\n        }\n    };\n    return MousePointRenderer;\n}());\nexports.MousePointRenderer = MousePointRenderer;\n","\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar gl_resource_1 = __importDefault(require(\"./gl-utils/gl-resource\"));\nvar fbo_1 = __importDefault(require(\"./gl-utils/fbo\"));\nvar ObstacleMapShaders = __importStar(require(\"./shaders/obstacle-map-shaders\"));\nvar dynamic_obstacle_1 = require(\"./dynamic-obstacle\");\nvar ObstacleMap = (function (_super) {\n    __extends(ObstacleMap, _super);\n    function ObstacleMap(gl, width, height) {\n        var _this = _super.call(this, gl) || this;\n        _this._width = width;\n        _this._height = height;\n        _this._fbo = new fbo_1.default(gl, width, height);\n        _this._drawShader = ObstacleMapShaders.buildDrawShader(gl);\n        _this._addShader = ObstacleMapShaders.buildAddShader(gl);\n        _this._dynamicObstacleSystem = new dynamic_obstacle_1.DynamicObstacleSystem(width, height);\n        _this.initObstaclesMap();\n        return _this;\n    }\n    ObstacleMap.prototype.freeGLResources = function () {\n        var gl = _super.prototype.gl.call(this);\n        this._fbo.freeGLResources();\n        gl.deleteTexture(this._texture);\n        gl.deleteTexture(this._initTexture);\n        this._drawShader.freeGLResources();\n        this._addShader.freeGLResources();\n    };\n    Object.defineProperty(ObstacleMap.prototype, \"texture\", {\n        get: function () {\n            return this._texture;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ObstacleMap.prototype.draw = function () {\n        var gl = _super.prototype.gl.call(this);\n        var drawShader = this._drawShader;\n        drawShader.u[\"uObstacles\"].value = this.texture;\n        drawShader.use();\n        drawShader.bindUniformsAndAttributes();\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    };\n    ObstacleMap.prototype.addObstacle = function (pos, size) {\n        var gl = _super.prototype.gl.call(this);\n        var addShader = this._addShader;\n        addShader.u[\"uSize\"].value = pos;\n        addShader.u[\"uPos\"].value = size;\n        this._fbo.bind([this._texture]);\n        addShader.use();\n        addShader.bindUniformsAndAttributes();\n        gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n    };\n    ObstacleMap.prototype.createDynamicObstacle = function (pos, size, mass, friction, restitution) {\n        if (size === void 0) { size = [0.02, 0.02]; }\n        if (mass === void 0) { mass = 1.0; }\n        if (friction === void 0) { friction = 0.95; }\n        if (restitution === void 0) { restitution = 0.8; }\n        return this._dynamicObstacleSystem.createObstacle(pos, size, mass, friction, restitution);\n    };\n    ObstacleMap.prototype.updateDynamicObstacles = function (mousePoints, deltaTime) {\n        this._dynamicObstacleSystem.update(mousePoints, deltaTime);\n        this.updateDynamicObstacleTexture();\n    };\n    ObstacleMap.prototype.getDynamicObstacles = function () {\n        return this._dynamicObstacleSystem.getObstacles();\n    };\n    ObstacleMap.prototype.clearDynamicObstacles = function () {\n        this._dynamicObstacleSystem.clear();\n    };\n    ObstacleMap.prototype.updateDynamicObstacleTexture = function () {\n        var gl = _super.prototype.gl.call(this);\n        this.resetToInitialState();\n        var obstacles = this._dynamicObstacleSystem.getObstacles();\n        for (var _i = 0, obstacles_1 = obstacles; _i < obstacles_1.length; _i++) {\n            var obstacle = obstacles_1[_i];\n            this.addObstacle(obstacle.size, obstacle.pos);\n        }\n    };\n    ObstacleMap.prototype.resetToInitialState = function () {\n        var gl = _super.prototype.gl.call(this);\n        this._fbo.bind([this._texture]);\n        gl.clearColor(0, 0, 0, 0);\n        gl.clear(gl.COLOR_BUFFER_BIT);\n        var width = this._width;\n        var height = this._height;\n        var texels = [];\n        for (var iY = 0; iY < height; ++iY) {\n            for (var iX = 0; iX < width; ++iX) {\n                if (iY === 0) {\n                    texels.push.apply(texels, [127, 255, 0, 255]);\n                }\n                else if (iY === height - 1) {\n                    texels.push.apply(texels, [127, 0, 0, 255]);\n                }\n                else if (iX === 0) {\n                    texels.push.apply(texels, [255, 127, 0, 255]);\n                }\n                else if (iX === width - 1) {\n                    texels.push.apply(texels, [0, 127, 0, 255]);\n                }\n                else {\n                    texels.push.apply(texels, [127, 127, 0, 255]);\n                }\n            }\n        }\n        var data = new Uint8Array(texels);\n        gl.bindTexture(gl.TEXTURE_2D, this._texture);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, data);\n    };\n    ObstacleMap.prototype.initObstaclesMap = function () {\n        var gl = _super.prototype.gl.call(this);\n        var width = this._width;\n        var height = this._height;\n        var texels = [];\n        for (var iY = 0; iY < height; ++iY) {\n            for (var iX = 0; iX < width; ++iX) {\n                if (iY === 0) {\n                    texels.push.apply(texels, [127, 255, 0, 255]);\n                }\n                else if (iY === height - 1) {\n                    texels.push.apply(texels, [127, 0, 0, 255]);\n                }\n                else if (iX === 0) {\n                    texels.push.apply(texels, [255, 127, 0, 255]);\n                }\n                else if (iX === width - 1) {\n                    texels.push.apply(texels, [0, 127, 0, 255]);\n                }\n                else {\n                    texels.push.apply(texels, [127, 127, 0, 255]);\n                }\n            }\n        }\n        var data = new Uint8Array(texels);\n        var textures = [];\n        for (var i = 0; i < 2; ++i) {\n            var tex = gl.createTexture();\n            gl.bindTexture(gl.TEXTURE_2D, tex);\n            gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, data);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n            gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n            textures.push(tex);\n        }\n        gl.bindTexture(gl.TEXTURE_2D, null);\n        this._texture = textures[0];\n        this._initTexture = textures[1];\n    };\n    ObstacleMap.prototype.addDynamicObstacleVelocityToFluid = function (fluid) {\n        var obstacles = this._dynamicObstacleSystem.getObstacles();\n        for (var _i = 0, obstacles_2 = obstacles; _i < obstacles_2.length; _i++) {\n            var obstacle = obstacles_2[_i];\n            var influenceRadius = Math.max(obstacle.size[0], obstacle.size[1]) * 1.5;\n            var brushSize = [influenceRadius, influenceRadius];\n            var velocityScale = 0.5;\n            var addVel = [\n                obstacle.vel[0] * velocityScale,\n                obstacle.vel[1] * velocityScale\n            ];\n            var speed = Math.sqrt(obstacle.vel[0] * obstacle.vel[0] + obstacle.vel[1] * obstacle.vel[1]);\n            if (speed > 0.001) {\n                fluid.addVel(obstacle.pos, brushSize, addVel);\n            }\n        }\n    };\n    return ObstacleMap;\n}(gl_resource_1.default));\nexports.default = ObstacleMap;\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.fluid = exports.obstacles = exports.display = exports.brush = exports.bind = exports.mouse = void 0;\nvar Requirements = __importStar(require(\"./requirements\"));\nrequire(\"./page-interface-generated\");\nvar Mouse = (function () {\n    function Mouse() {\n        var _this = this;\n        this._posInPx = [0, 0];\n        this._pivotInPx = [0, 0];\n        this.setPosInPx([0, 0]);\n        this.setMovementInPx([0, 0]);\n        Page.Canvas.Observers.mouseMove.push(function (relX, relY) {\n            var canvasSize = Page.Canvas.getSize();\n            _this.setPosInPx([canvasSize[0] * relX, canvasSize[1] * (1 - relY)]);\n        });\n        Page.Canvas.Observers.mouseDown.push(function () {\n            _this.setMovementInPx([0, 0]);\n            _this._pivotInPx = _this._posInPx;\n        });\n    }\n    Object.defineProperty(Mouse.prototype, \"posInPx\", {\n        get: function () {\n            return this._posInPx;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Mouse.prototype, \"pos\", {\n        get: function () {\n            return this._pos;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Mouse.prototype, \"movementInPx\", {\n        get: function () {\n            return this._movementInPx;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Mouse.prototype, \"movement\", {\n        get: function () {\n            return this._movement;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Mouse.prototype.setPosInPx = function (pos) {\n        var toPivot = [\n            this._pivotInPx[0] - pos[0],\n            this._pivotInPx[1] - pos[1]\n        ];\n        var distToPivot = Math.sqrt(toPivot[0] * toPivot[0] + toPivot[1] * toPivot[1]);\n        var maxDist = 16;\n        if (distToPivot > maxDist) {\n            toPivot[0] *= maxDist / distToPivot;\n            toPivot[1] *= maxDist / distToPivot;\n            this._pivotInPx[0] = pos[0] + toPivot[0];\n            this._pivotInPx[1] = pos[1] + toPivot[1];\n        }\n        var movementInPx = [-toPivot[0] / maxDist, -toPivot[1] / maxDist];\n        this.setMovementInPx(movementInPx);\n        this._posInPx = pos;\n        this._pos = this.setRelative(pos);\n    };\n    Mouse.prototype.setMovementInPx = function (movement) {\n        this._movementInPx = movement;\n        this._movement = this.setRelative(movement);\n    };\n    Mouse.prototype.setRelative = function (pos) {\n        var canvasSize = Page.Canvas.getSize();\n        return [\n            pos[0] / canvasSize[0],\n            pos[1] / canvasSize[1],\n        ];\n    };\n    return Mouse;\n}());\nvar mouse = new Mouse();\nexports.mouse = mouse;\nfunction bindMouse() {\n    exports.mouse = mouse = new Mouse();\n}\nvar brushInfo = {\n    radius: 10,\n    strength: 100,\n};\nexports.brush = brushInfo;\nvar fluidInfo = {\n    stream: true,\n};\nexports.fluid = fluidInfo;\nvar ObstaclesInfo;\n(function (ObstaclesInfo) {\n    ObstaclesInfo[\"NONE\"] = \"none\";\n    ObstaclesInfo[\"ONE\"] = \"one\";\n    ObstaclesInfo[\"MANY\"] = \"many\";\n    ObstaclesInfo[\"DYNAMIC\"] = \"dynamic\";\n})(ObstaclesInfo || (ObstaclesInfo = {}));\nvar obstaclesInfo = ObstaclesInfo.NONE;\nexports.obstacles = obstaclesInfo;\nvar displayInfo = {\n    velocity: true,\n    pressure: true,\n    brush: true,\n    obstacles: true,\n};\nexports.display = displayInfo;\nfunction bindControls(fluid) {\n    {\n        var RESOLUTIONS_CONTROL_ID = \"resolution\";\n        var updateResolution = function (values) {\n            var size = +values[0];\n            fluid.reset(size, size);\n        };\n        Page.Tabs.addObserver(RESOLUTIONS_CONTROL_ID, updateResolution);\n        updateResolution(Page.Tabs.getValues(RESOLUTIONS_CONTROL_ID));\n    }\n    {\n        var FLOAT_CONTROL_ID = \"float-texture-checkbox-id\";\n        if (!Requirements.allExtensionsLoaded) {\n            Page.Controls.setVisibility(FLOAT_CONTROL_ID, false);\n            Page.Checkbox.setChecked(FLOAT_CONTROL_ID, false);\n        }\n        var updateFloat = function (use) { fluid.useFloatTextures = use; };\n        Page.Checkbox.addObserver(FLOAT_CONTROL_ID, updateFloat);\n        updateFloat(Page.Checkbox.isChecked(FLOAT_CONTROL_ID));\n    }\n    {\n        var ITERATIONS_CONTROL_ID = \"solver-steps-range-id\";\n        var updateIterations = function (iterations) { fluid.minNbIterations = iterations; };\n        Page.Range.addObserver(ITERATIONS_CONTROL_ID, updateIterations);\n        updateIterations(Page.Range.getValue(ITERATIONS_CONTROL_ID));\n    }\n    {\n        var TIMESTEP_CONTROL_ID = \"timestep-range-id\";\n        var updateTimestep = function (timestep) { fluid.timestep = timestep; };\n        Page.Range.addObserver(TIMESTEP_CONTROL_ID, updateTimestep);\n        updateTimestep(Page.Range.getValue(TIMESTEP_CONTROL_ID));\n    }\n    {\n        var STREAM_CONTROL_ID = \"stream-checkbox-id\";\n        var updateStream = function (doStream) { fluidInfo.stream = doStream; };\n        Page.Checkbox.addObserver(STREAM_CONTROL_ID, updateStream);\n        updateStream(Page.Checkbox.isChecked(STREAM_CONTROL_ID));\n    }\n    {\n        var OBSTACLES_CONTROL_ID = \"obstacles\";\n        var updateObstacles = function (values) {\n            exports.obstacles = obstaclesInfo = values[0];\n        };\n        Page.Tabs.addObserver(OBSTACLES_CONTROL_ID, updateObstacles);\n        updateObstacles(Page.Tabs.getValues(OBSTACLES_CONTROL_ID));\n    }\n    {\n        var BRUSH_RADIUS_CONTROL_ID_1 = \"brush-radius-range-id\";\n        var updateBrushRadius_1 = function (radius) { brushInfo.radius = radius; };\n        Page.Range.addObserver(BRUSH_RADIUS_CONTROL_ID_1, updateBrushRadius_1);\n        updateBrushRadius_1(Page.Range.getValue(BRUSH_RADIUS_CONTROL_ID_1));\n        Page.Canvas.Observers.mouseWheel.push(function (delta) {\n            Page.Range.setValue(BRUSH_RADIUS_CONTROL_ID_1, brushInfo.radius + 5 * delta);\n            updateBrushRadius_1(Page.Range.getValue(BRUSH_RADIUS_CONTROL_ID_1));\n        });\n    }\n    {\n        var BRUSH_STRENGTH_CONTROL_ID = \"brush-strength-range-id\";\n        var updateBrushStrength = function (strength) { brushInfo.strength = strength; };\n        Page.Range.addObserver(BRUSH_STRENGTH_CONTROL_ID, updateBrushStrength);\n        updateBrushStrength(Page.Range.getValue(BRUSH_STRENGTH_CONTROL_ID));\n    }\n    {\n        var DISPLAY_MODE_CONTROL_ID = \"displayed-fields\";\n        var updateDisplayMode = function (modes) {\n            displayInfo.velocity = modes[0] === \"velocity\" || modes[1] === \"velocity\";\n            displayInfo.pressure = modes[0] === \"pressure\" || modes[1] === \"pressure\";\n        };\n        Page.Tabs.addObserver(DISPLAY_MODE_CONTROL_ID, updateDisplayMode);\n        updateDisplayMode(Page.Tabs.getValues(DISPLAY_MODE_CONTROL_ID));\n    }\n    {\n        var COLOR_INTENSITY_CONTROL_ID = \"intensity-range-id\";\n        var updateColorIntensity = function (intensity) { fluid.colorIntensity = intensity; };\n        Page.Range.addObserver(COLOR_INTENSITY_CONTROL_ID, updateColorIntensity);\n        updateColorIntensity(Page.Range.getValue(COLOR_INTENSITY_CONTROL_ID));\n    }\n    {\n        var DISPLAY_COLOR_CONTROL_ID = \"display-color-checkbox-id\";\n        var updateColor = function (display) { fluid.color = display; };\n        Page.Checkbox.addObserver(DISPLAY_COLOR_CONTROL_ID, updateColor);\n        updateColor(Page.Checkbox.isChecked(DISPLAY_COLOR_CONTROL_ID));\n    }\n    {\n        var DISPLAY_OBSTACLES_CONTROL_ID = \"display-obstacles-checkbox-id\";\n        var updateDisplayObstacles = function (display) { displayInfo.obstacles = display; };\n        Page.Checkbox.addObserver(DISPLAY_OBSTACLES_CONTROL_ID, updateDisplayObstacles);\n        updateDisplayObstacles(Page.Checkbox.isChecked(DISPLAY_OBSTACLES_CONTROL_ID));\n    }\n}\nfunction bind(fluid) {\n    bindControls(fluid);\n    bindMouse();\n}\nexports.bind = bind;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.allExtensionsLoaded = exports.loadExtensions = exports.check = void 0;\nrequire(\"./page-interface-generated\");\nfunction check(gl) {\n    function setError(message) {\n        Page.Demopage.setErrorMessage(\"webgl-requirements\", message);\n    }\n    var mediump = gl.getShaderPrecisionFormat(gl.FRAGMENT_SHADER, gl.MEDIUM_FLOAT);\n    if (mediump.precision < 23) {\n        Page.Demopage.setErrorMessage(\"webgl-requirements\", \"Your device only supports low precision float in fragment shader.\\n\" +\n            \"The simulation will not run.\");\n        return false;\n    }\n    return true;\n}\nexports.check = check;\nvar allExtensionsLoaded = false;\nexports.allExtensionsLoaded = allExtensionsLoaded;\nfunction loadExtensions(gl, extensions) {\n    exports.allExtensionsLoaded = allExtensionsLoaded = true;\n    var i = 0;\n    for (var _i = 0, extensions_1 = extensions; _i < extensions_1.length; _i++) {\n        var ext = extensions_1[_i];\n        if (!gl.getExtension(ext)) {\n            Page.Demopage.setErrorMessage(\"no-ext\" + i, \"Cannot load WebGL extension '\" + ext + \"'.\");\n            exports.allExtensionsLoaded = allExtensionsLoaded = false;\n        }\n        ++i;\n    }\n}\nexports.loadExtensions = loadExtensions;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.buildDrawShader = void 0;\nvar shader_1 = __importDefault(require(\"../gl-utils/shader\"));\nvar vbo_1 = __importDefault(require(\"../gl-utils/vbo\"));\nvar build_shaders_1 = require(\"./build-shaders\");\nvar drawVert = \"uniform vec2 uBrushSize; //relative, in [0,1]x[0,1]\\nuniform vec2 uBrushPos; //relative, in [0,1]x[0,1]\\n\\nattribute vec2 aCorner; //in {-1,+1}x{-1,+1}\\n\\nvarying vec2 toCenter;\\n\\nvoid main(void) {\\n    toCenter = -aCorner;\\n\\n    vec2 pos = uBrushPos + aCorner * uBrushSize;\\n\\n    gl_Position = vec4(2.0 * pos - 1.0, 0, 1);\\n}\";\nvar drawFrag = \"precision mediump float;\\n\\nuniform float uThickness; //relative to brushRadius\\n\\nvarying vec2 toCenter;\\n\\nvoid main(void) {\\n    float dist = length(toCenter);\\n    if (dist < 1.0-uThickness || dist > 1.0)\\n        discard;\\n\\n    const vec3 color = vec3(1);\\n\\n    gl_FragColor = vec4(color, 1.0);\\n}\";\nvar drawSrc = new build_shaders_1.ShaderSrc(drawVert, drawFrag);\nfunction buildDrawShader(gl) {\n    var shader = new shader_1.default(gl, drawSrc.vert, drawSrc.frag);\n    shader.a[\"aCorner\"].VBO = vbo_1.default.createQuad(gl, -1, -1, +1, +1);\n    return shader;\n}\nexports.buildDrawShader = buildDrawShader;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ShaderSrc = exports.fetch = void 0;\nfunction fetch(filepath) {\n    var request = new XMLHttpRequest();\n    request.open('GET', filepath, false);\n    request.send();\n    return request.responseText;\n}\nexports.fetch = fetch;\n;\nvar ShaderSrc = (function () {\n    function ShaderSrc(vert, frag) {\n        this.vert = vert;\n        this.frag = frag;\n    }\n    ShaderSrc.prototype.batchReplace = function (includes) {\n        for (var _i = 0, includes_1 = includes; _i < includes_1.length; _i++) {\n            var include = includes_1[_i];\n            this.vert = this.vert.replace(new RegExp(include.toReplace), include.replacement);\n            this.frag = this.frag.replace(new RegExp(include.toReplace), include.replacement);\n        }\n    };\n    ShaderSrc.fromScript = function (vertId, fragId) {\n        var vert = document.getElementById(vertId).text;\n        var frag = document.getElementById(fragId).text;\n        return new ShaderSrc(vert, frag);\n    };\n    return ShaderSrc;\n}());\nexports.ShaderSrc = ShaderSrc;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.setUseFloatTextures = exports.buildObstaclesVelocityShader = exports.buildSubstractGradientShader = exports.buildDivergenceShader = exports.buildJacobiPressureShader = exports.buildAdvectShader = exports.buildAddVelShader = exports.buildDrawPressureShader = exports.buildDrawVelocityShader = void 0;\nvar shader_1 = __importDefault(require(\"../gl-utils/shader\"));\nvar vbo_1 = __importDefault(require(\"../gl-utils/vbo\"));\nvar build_shaders_1 = require(\"./build-shaders\");\nvar obstacle_map_shaders_1 = require(\"./obstacle-map-shaders\");\nvar rawEncodingStr = \"const float MAX_SPEED = 1.0;\\nconst float SPEED_BANDWIDTH = 2.01 * MAX_SPEED;\\n\\nconst float MIN_DIVERGENCE = -4.0 * MAX_SPEED;\\nconst float MAX_DIVERGENCE =  4.0 * MAX_SPEED;\\nconst float DIVERGENCE_BANDWIDTH = MAX_DIVERGENCE - MIN_DIVERGENCE;\\n\\nconst float MIN_PRESSURE = 0.5 * MIN_DIVERGENCE;\\nconst float MAX_PRESSURE = 0.5 * MAX_DIVERGENCE;\\nconst float PRESSURE_BANDWIDTH = MAX_PRESSURE - MIN_PRESSURE;\\n\\n/* Decodes a float value (32 bits in [0,1])\\n * from a 4D value (4x8bits in [0,1]x[0,1]x[0,1]x[0,1]) */\\nfloat decode32bit(vec4 v)\\n{\\n    const vec4 weights = 255.0 * vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0) / (256.0*256.0*256.0*256.0 - 1.0);\\n    return dot(weights, v);\\n}\\n\\n/* Encodes a float value (32 bits in [0,1])\\n * into a 4D value (4x8bits in [0,1]x[0,1]x[0,1]x[0,1]) */\\nvec4 encode32bit(float f)\\n{\\n    const vec4 base = (256.0*256.0*256.0*256.0 - 1.0) / vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);\\n    return floor(mod(f * base, 256.0)) / 255.0;\\n}\\n\\n/* Decodes a float value (16 bits in [0,1])\\n * from a 2D value (2x8bits in [0,1]x[0,1]) */\\nfloat decode16bit(vec2 v)\\n{\\n    const vec2 weights = 255.0 * vec2(256.0, 1.0) / (256.0*256.0 - 1.0);\\n    return dot(weights, v);\\n}\\n\\n/* Encodes a float value (16 bits in [0,1])\\n * into a 2D value (2x8bits in [0,1]x[0,1]) */\\nvec2 encode16bit(float f)\\n{\\n    const vec2 base = (256.0*256.0 - 1.0) / vec2(256.0, 1.0);\\n    return floor(mod(f * base, 256.0)) / 255.0;\\n}\\n\\nfloat decodeDivergence(vec4 texel) {\\n    float div = decode32bit(texel);\\n    return div * DIVERGENCE_BANDWIDTH + MIN_DIVERGENCE;\\n}\\nvec4 encodeDivergence(float div) {\\n    div = (div - MIN_DIVERGENCE) / DIVERGENCE_BANDWIDTH;\\n    return encode32bit(div);\\n}\\n\\nfloat decodePressure(vec4 texel) {\\n    float p = decode32bit(texel);\\n    return p * PRESSURE_BANDWIDTH + MIN_PRESSURE;\\n}\\nvec4 encodePressure(float p) {\\n    p = (p - MIN_PRESSURE) / PRESSURE_BANDWIDTH;\\n    return encode32bit(p);\\n}\\n\\n___ENCODING_VELOCITY___\\n\\n___ENCODING_OBSTACLES___\";\nvar encodingVelocityFloatStr = \"vec4 encodeVelocity(vec2 vel) {\\n    return vec4(vel, 0, 0);\\n}\\nvec2 decodeVelocity(vec4 texel) {\\n    return texel.rg;\\n}\";\nvar encodingVelocityNoFloatStr = \"vec4 encodeVelocity(vec2 vel) {\\n    vel = 0.5 * (vel / MAX_SPEED + 1.0);\\n    return vec4(encode16bit(vel.x), encode16bit(vel.y));\\n}\\nvec2 decodeVelocity(vec4 texel) {\\n    vec2 vel = vec2(decode16bit(texel.rg), decode16bit(texel.ba));\\n    return (2.0 * vel - 1.0) * MAX_SPEED;\\n}\";\nvar addVelVert = \"uniform vec2 uBrushSize; //relative, in [0,1]x[0,1]\\nuniform vec2 uBrushPos; //relative, in [0,1]x[0,1]\\n\\nattribute vec2 aCorner; //{0,1}x{0,1}\\n\\nvarying vec2 sampleCoords;\\nvarying vec2 toBrush;\\n\\nvoid main(void) {\\n    sampleCoords = aCorner;\\n    toBrush = (uBrushPos - aCorner) / uBrushSize;\\n\\n    gl_Position = vec4(2.0*aCorner - 1.0, 0.0, 1.0);\\n}\";\nvar addVelFrag = \"precision mediump float;\\n\\nuniform sampler2D uVel;\\n\\nuniform vec2 uAddVel;\\n\\nvarying vec2 sampleCoords;\\nvarying vec2 toBrush;\\n\\n___ENCODING___\\n\\nvoid main(void) {\\n    vec2 vel = decodeVelocity(texture2D(uVel, sampleCoords));\\n\\n    float influence = 1.0 - clamp(length(toBrush), 0.0, 1.0);\\n    vec2 toAdd = influence * uAddVel;\\n\\n    vel += toAdd;\\n    vel *= min(1.0, MAX_SPEED / length(vel));\\n\\n    gl_FragColor = encodeVelocity(vel);\\n}\";\nvar fullscreenVert = \"attribute vec2 aCorner; //{0,1}x{0,1}\\n\\nvarying vec2 sampleCoords;\\n\\nvoid main(void) {\\n    sampleCoords = aCorner;\\n    gl_Position = vec4(2.0*aCorner - 1.0, 0.0, 1.0);\\n}\";\nvar advectFrag = \"precision mediump float;\\n\\nuniform sampler2D uQuantity; //thing to advect\\nuniform sampler2D uVel;\\n\\nuniform vec2 uVelUnit;\\nuniform float uDt;\\n\\nvarying vec2 sampleCoords;\\n\\n___ENCODING___\\n\\nvoid main(void) {\\n    vec2 vel = decodeVelocity(texture2D(uVel, sampleCoords));\\n    vec2 pos = sampleCoords - uDt * vel * uVelUnit;\\n    gl_FragColor = texture2D(uQuantity, pos);\\n}\";\nvar jacobiPressureFrag = \"precision mediump float;\\n\\nuniform sampler2D uPrevIter; //x\\nuniform sampler2D uConstantTerm; //b\\nuniform sampler2D uObstacles;\\n\\nuniform float uAlpha;\\nuniform float uInvBeta;\\n\\nuniform vec2 uTexelSize;\\n\\nvarying vec2 sampleCoords;\\n\\n___ENCODING___\\n\\nvoid main(void) {\\n    vec2 obstacle = decodeObstacle(texture2D(uObstacles, sampleCoords));\\n    vec2 coords = sampleCoords + uTexelSize * obstacle;\\n\\n    float result = decodePressure(texture2D(uPrevIter, coords - vec2(uTexelSize.x,0))) +\\n                   decodePressure(texture2D(uPrevIter, coords + vec2(uTexelSize.x,0))) +\\n                   decodePressure(texture2D(uPrevIter, coords - vec2(0,uTexelSize.y))) +\\n                   decodePressure(texture2D(uPrevIter, coords + vec2(0,uTexelSize.y)));\\n\\n    result += uAlpha * decodeDivergence(texture2D(uConstantTerm, coords));\\n    result *= uInvBeta;\\n    result = clamp(result, MIN_PRESSURE, MAX_PRESSURE);\\n\\n    gl_FragColor = encodePressure(result);\\n}\";\nvar divergenceFrag = \"precision mediump float;\\n\\nuniform sampler2D uVelocity;\\n\\nuniform vec2 uTexelSize;\\n\\nvarying vec2 sampleCoords;\\n\\n___ENCODING___\\n\\nvoid main(void) {\\n    vec2 top =    decodeVelocity(texture2D(uVelocity, sampleCoords + vec2(0,uTexelSize.y)));\\n    vec2 bottom = decodeVelocity(texture2D(uVelocity, sampleCoords - vec2(0,uTexelSize.y)));\\n    vec2 left =   decodeVelocity(texture2D(uVelocity, sampleCoords - vec2(uTexelSize.x,0)));\\n    vec2 right =  decodeVelocity(texture2D(uVelocity, sampleCoords + vec2(uTexelSize.x,0)));\\n\\n    float div = ((right.x - left.x) + (top.y - bottom.y));\\n    div *= min(1.0, MAX_DIVERGENCE / length(div));\\n\\n    gl_FragColor = encodeDivergence(div);\\n}\";\nvar substractGradientFrag = \"precision mediump float;\\n\\nuniform sampler2D uVelocities;\\nuniform sampler2D uPressure;\\n\\nuniform vec2 uTexelSize;\\nuniform float uHalfInvDx;\\n\\nvarying vec2 sampleCoords;\\n\\n___ENCODING___\\n\\nvoid main(void) {\\n    float top =    decodePressure(texture2D(uPressure, sampleCoords + vec2(0,uTexelSize.y)));\\n    float bottom = decodePressure(texture2D(uPressure, sampleCoords - vec2(0,uTexelSize.y)));\\n    float left =   decodePressure(texture2D(uPressure, sampleCoords - vec2(uTexelSize.x,0)));\\n    float right =  decodePressure(texture2D(uPressure, sampleCoords + vec2(uTexelSize.x,0)));\\n\\n    vec2 grad = uHalfInvDx * vec2(right - left, top - bottom);\\n\\n    vec2 partialVel = decodeVelocity(texture2D(uVelocities, sampleCoords));\\n    vec2 divFreeVel = partialVel - grad;\\n    divFreeVel *= min(1.0, MAX_SPEED / length(divFreeVel));\\n\\n    gl_FragColor = encodeVelocity(divFreeVel);\\n}\";\nvar obstacleVelocityFrag = \"precision mediump float;\\n\\nuniform sampler2D uVelocities;\\nuniform sampler2D uObstacles;\\n\\nuniform vec2 uTexelSize;\\n\\nvarying vec2 sampleCoords;\\n\\n___ENCODING___\\n\\nvoid main(void) {\\n    vec2 obstacle = decodeObstacle(texture2D(uObstacles, sampleCoords));\\n    vec2 coords = sampleCoords + obstacle * uTexelSize;\\n\\n    vec2 vel = decodeVelocity(texture2D(uVelocities, coords));\\n    vel *= sign(0.5 - dot(obstacle,obstacle));\\n\\n    gl_FragColor = encodeVelocity(vel);\\n}\";\nvar drawVelocityFrag = \"precision mediump float;\\n\\nuniform sampler2D uVel;\\nuniform float uColorIntensity;\\nuniform bool uBlacknWhite;\\n\\nvarying vec2 sampleCoords;\\n\\n___ENCODING___\\n\\n/*\\n   /---__/     __\\n 0 1 2 3 4\\n*/\\nfloat bump(float x) {\\n  return min(mix(0.0, 1.0, clamp(x, 0.0, 1.0)),\\n             mix(1.0, 0.0, clamp(x-3.0, 0.0, 1.0)));\\n}\\n\\n/* Every hue, periodic with a period of 1 */\\nvec3 color(float value) {\\n    value *= 6.0;\\n    float r = bump(mod(value-4.0, 6.0));\\n    float g = bump(mod(value-0.0, 6.0));\\n    float b = bump(mod(value-2.0, 6.0));\\n    return vec3(r,g,b);\\n}\\n\\nvoid main(void) {\\n    vec2 vel = decodeVelocity(texture2D(uVel, sampleCoords)) / MAX_SPEED;\\n\\n    vec3 c = color(atan(vel.y, vel.x) / (2.0 * 3.14159));\\n    c = mix(c, vec3(1), float(uBlacknWhite));\\n\\n    float intensity = smoothstep(0.0, 1.0, uColorIntensity*length(vel));\\n\\n    gl_FragColor = vec4(intensity * c, 1);\\n}\";\nvar drawPressureFrag = \"precision mediump float;\\n\\nuniform sampler2D uPressure;\\nuniform float uColorIntensity;\\nuniform bool uBlacknWhite;\\n\\nvarying vec2 sampleCoords;\\n\\n___ENCODING___\\n\\nvec3 color(float value) {\\n    value = smoothstep(0.0, 1.0, clamp(value, 0.0, 1.0));\\n    value = smoothstep(0.0, 1.0, value);\\n\\n    float r = smoothstep(.5, .75, value);\\n    float g = min(smoothstep(.0, .25, value),\\n                  1.0 - smoothstep(.75, 1.0, value));\\n    float b = 1.0 - smoothstep(.25, .5, value);\\n    return vec3(r,g,b);\\n}\\n\\nvoid main(void) {\\n    float pressure = decodePressure(texture2D(uPressure, sampleCoords));\\n    pressure = pressure / MAX_PRESSURE;\\n    pressure = clamp(256.0*uColorIntensity*pressure, -.5, .5) + 0.5;\\n\\n    vec3 c = color(pressure);\\n    c = mix(c, vec3(pressure), float(uBlacknWhite));\\n\\n    gl_FragColor = vec4(c, 1);\\n}\";\nvar encodingStr = rawEncodingStr;\nsetUseFloatTextures(false);\nfunction setUseFloatTextures(useFloat) {\n    var replace = (useFloat) ? encodingVelocityFloatStr : encodingVelocityNoFloatStr;\n    encodingStr = rawEncodingStr.replace(/___ENCODING_VELOCITY___/g, replace);\n    encodingStr = encodingStr.replace(/___ENCODING_OBSTACLES___/g, obstacle_map_shaders_1.encodingStr);\n}\nexports.setUseFloatTextures = setUseFloatTextures;\nvar drawVelocitySrc = new build_shaders_1.ShaderSrc(fullscreenVert, drawVelocityFrag);\nvar drawPressureSrc = new build_shaders_1.ShaderSrc(fullscreenVert, drawPressureFrag);\nvar addVelSrc = new build_shaders_1.ShaderSrc(addVelVert, addVelFrag);\nvar advectSrc = new build_shaders_1.ShaderSrc(fullscreenVert, advectFrag);\nvar jacobiPressureSrc = new build_shaders_1.ShaderSrc(fullscreenVert, jacobiPressureFrag);\nvar divergenceSrc = new build_shaders_1.ShaderSrc(fullscreenVert, divergenceFrag);\nvar substractGradientSrc = new build_shaders_1.ShaderSrc(fullscreenVert, substractGradientFrag);\nvar obstaclesVelocitySrc = new build_shaders_1.ShaderSrc(fullscreenVert, obstacleVelocityFrag);\nfunction buildFullscreenShader(gl, src) {\n    var vertSrc = src.vert;\n    var fragSrc = src.frag.replace(/___ENCODING___/g, encodingStr);\n    var shader = new shader_1.default(gl, vertSrc, fragSrc);\n    shader.a[\"aCorner\"].VBO = vbo_1.default.createQuad(gl, 0, 0, 1, 1);\n    return shader;\n}\nfunction buildDrawVelocityShader(gl) {\n    return buildFullscreenShader(gl, drawVelocitySrc);\n}\nexports.buildDrawVelocityShader = buildDrawVelocityShader;\nfunction buildDrawPressureShader(gl) {\n    return buildFullscreenShader(gl, drawPressureSrc);\n}\nexports.buildDrawPressureShader = buildDrawPressureShader;\nfunction buildAddVelShader(gl) {\n    return buildFullscreenShader(gl, addVelSrc);\n}\nexports.buildAddVelShader = buildAddVelShader;\nfunction buildAdvectShader(gl) {\n    return buildFullscreenShader(gl, advectSrc);\n}\nexports.buildAdvectShader = buildAdvectShader;\nfunction buildJacobiPressureShader(gl) {\n    return buildFullscreenShader(gl, jacobiPressureSrc);\n}\nexports.buildJacobiPressureShader = buildJacobiPressureShader;\nfunction buildDivergenceShader(gl) {\n    return buildFullscreenShader(gl, divergenceSrc);\n}\nexports.buildDivergenceShader = buildDivergenceShader;\nfunction buildSubstractGradientShader(gl) {\n    return buildFullscreenShader(gl, substractGradientSrc);\n}\nexports.buildSubstractGradientShader = buildSubstractGradientShader;\nfunction buildObstaclesVelocityShader(gl) {\n    return buildFullscreenShader(gl, obstaclesVelocitySrc);\n}\nexports.buildObstaclesVelocityShader = buildObstaclesVelocityShader;\n","\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.encodingStr = exports.buildAddShader = exports.buildDrawShader = void 0;\nvar shader_1 = __importDefault(require(\"../gl-utils/shader\"));\nvar vbo_1 = __importDefault(require(\"../gl-utils/vbo\"));\nvar build_shaders_1 = require(\"./build-shaders\");\nvar encodingStr = \"vec4 encodeObstacle(vec2 normal) {\\n  normal = clamp(normalize(normal), -1.0, 1.0);\\n  return vec4(0.5 * normal + 0.5, 0, 0);\\n}\\nvec2 decodeObstacle(vec4 texel) {\\n  return 2.0 * texel.rg - 1.0;\\n}\";\nexports.encodingStr = encodingStr;\nvar drawVert = \"attribute vec2 aCorner; //{0,1}x{0,1}\\n\\nvarying vec2 sampleCoords;\\n\\nvoid main(void) {\\n    sampleCoords = aCorner;\\n    gl_Position = vec4(2.0*aCorner - 1.0, 0.0, 1.0);\\n}\";\nvar drawFrag = \"precision mediump float;\\n\\nuniform sampler2D uObstacles;\\n\\nvarying vec2 sampleCoords;\\n\\n___ENCODING___\\n\\nvoid main(void) {\\n    vec2 obstacle = decodeObstacle(texture2D(uObstacles, sampleCoords));\\n    if (dot(obstacle, obstacle) < 0.5)\\n        discard;\\n\\n    gl_FragColor = vec4(0.5*obstacle + 0.5, 0, 0);\\n}\";\nvar addObstacleVert = \"uniform vec2 uSize; //relative, in [0,1]x[0,1]\\nuniform vec2 uPos; //relative, in [0,1]x[0,1]\\n\\nattribute vec2 aCorner; //in {-1,+1}x{-1,+1}\\n\\nvarying vec2 toCenter;\\n\\nvoid main(void) {\\n    toCenter = -aCorner;\\n\\n    vec2 pos = uPos + aCorner * uSize;\\n\\n    gl_Position = vec4(2.0 * pos - 1.0, 0, 1);\\n}\";\nvar addObstacleFrag = \"precision mediump float;\\n\\nvarying vec2 toCenter;\\n\\n___ENCODING___\\n\\nvoid main(void) {\\n    float dist = length(toCenter);\\n    if (dist > 1.0)\\n        discard;\\n\\n    vec2 normal = -toCenter / dist;\\n    gl_FragColor = encodeObstacle(normal);\\n}\";\nvar includes = [\n    { toReplace: \"___ENCODING___\", replacement: encodingStr },\n];\nvar drawSrc = new build_shaders_1.ShaderSrc(drawVert, drawFrag);\ndrawSrc.batchReplace(includes);\nvar addSrc = new build_shaders_1.ShaderSrc(addObstacleVert, addObstacleFrag);\naddSrc.batchReplace(includes);\nfunction buildDrawShader(gl) {\n    var shader = new shader_1.default(gl, drawSrc.vert, drawSrc.frag);\n    shader.a[\"aCorner\"].VBO = vbo_1.default.createQuad(gl, 0, 0, 1, 1);\n    return shader;\n}\nexports.buildDrawShader = buildDrawShader;\nfunction buildAddShader(gl) {\n    var shader = new shader_1.default(gl, addSrc.vert, addSrc.frag);\n    shader.a[\"aCorner\"].VBO = vbo_1.default.createQuad(gl, -1, -1, 1, 1);\n    return shader;\n}\nexports.buildAddShader = buildAddShader;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MultiMouseWS = void 0;\nvar MultiMouseWS = (function () {\n    function MultiMouseWS(url, onPointsUpdate, fps) {\n        if (fps === void 0) { fps = 10; }\n        this.url = url;\n        this.points = [];\n        this.onPointsUpdate = onPointsUpdate;\n        this.ws = null;\n        this.isConnected = false;\n        this.fps = fps;\n        this.sendInterval = null;\n    }\n    MultiMouseWS.prototype.connect = function () {\n        var _this = this;\n        this.ws = new WebSocket(this.url);\n        this.ws.onopen = function () {\n            console.log('WS connected');\n            _this.isConnected = true;\n            _this.startSendLoop();\n        };\n        this.ws.onclose = function () {\n            console.log('WS closed');\n            _this.isConnected = false;\n            _this.stopSendLoop();\n        };\n        this.ws.onerror = function (err) {\n            console.error('WS error', err);\n            _this.isConnected = false;\n        };\n        this.ws.onmessage = function (ev) {\n            var _a;\n            try {\n                var data = JSON.parse(ev.data);\n                if (Array.isArray(data)) {\n                    if (typeof ((_a = data[0]) === null || _a === void 0 ? void 0 : _a.pos) !== \"undefined\") {\n                        _this.points = data;\n                    }\n                    else {\n                        _this.points = data.map(function (_a) {\n                            var x = _a[0], y = _a[1];\n                            return ({ pos: [x, y], movement: [0, 0] });\n                        });\n                    }\n                    if (_this.onPointsUpdate)\n                        _this.onPointsUpdate(_this.points);\n                }\n            }\n            catch (e) {\n                console.warn('Non-JSON message:', ev.data);\n            }\n        };\n    };\n    MultiMouseWS.prototype.startSendLoop = function () {\n        var _this = this;\n        var interval = 1000 / this.fps;\n        this.sendInterval = window.setInterval(function () {\n            if (_this.ws && _this.ws.readyState === WebSocket.OPEN) {\n                _this.ws.send('detect');\n            }\n        }, interval);\n    };\n    MultiMouseWS.prototype.stopSendLoop = function () {\n        if (this.sendInterval !== null) {\n            clearInterval(this.sendInterval);\n            this.sendInterval = null;\n        }\n    };\n    MultiMouseWS.prototype.disconnect = function () {\n        this.stopSendLoop();\n        if (this.ws) {\n            this.ws.close();\n            this.ws = null;\n        }\n        this.isConnected = false;\n    };\n    MultiMouseWS.prototype.setFPS = function (fps) {\n        this.fps = fps;\n        if (this.isConnected) {\n            this.stopSendLoop();\n            this.startSendLoop();\n        }\n    };\n    return MultiMouseWS;\n}());\nexports.MultiMouseWS = MultiMouseWS;\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(633);\n"],"names":["extendStatics","__extends","this","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__createBinding","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","__importDefault","exports","gl_resource_1","Parameters","BrushShaders","Brush","_super","gl","_this","_drawShader","buildDrawShader","thickness","freeGLResources","draw","canvas","canvasSize","clientWidth","clientHeight","drawShader","use","brushSize","brush","radius","u","mouse","pos","bindUniformsAndAttributes","drawArrays","TRIANGLE_STRIP","default","__assign","assign","t","s","i","n","arguments","length","apply","DynamicObstacleController","obstacleMap","mouseRenderer","controlPanel","config","enabled","autoCreate","maxObstacles","defaultMass","defaultFriction","defaultRestitution","defaultSize","createControlPanel","setEnabled","clearDynamicObstacles","updateDynamicObstacles","updateControlPanel","isEnabled","addObstacle","size","mass","friction","restitution","console","warn","getDynamicObstacles","concat","finalPos","Math","random","finalSize","finalMass","finalFriction","finalRestitution","obstacle","createDynamicObstacle","log","id","removeObstacle","find","obs","splice","indexOf","clearAllObstacles","updateConfig","newConfig","getConfig","document","createElement","style","cssText","body","appendChild","obstacles","innerHTML","map","toFixed","join","bindControlEvents","enableToggle","querySelector","addEventListener","e","target","checked","forEach","input","parseFloat","addButton","clearButton","window","dynamicObstacleController","update","mousePoints","deltaTime","destroy","parentElement","removeChild","DynamicObstacleSystem","canvasWidth","canvasHeight","nextId","createObstacle","vel","push","checkPointObstacleCollision","point","dx","dy","distance","sqrt","obstacleRadius","collisionDistance","isCollision","handlePointObstacleCollision","movement","nx","ny","velAlongNormal","j","impulseX","impulseY","overlap","separationX","separationY","handleBoundaryCollision","halfSizeX","halfSizeY","handleObstacleCollisions","obs1","obs2","minDistance","j_1","min","_i","mousePoints_1","_a","_b","_c","_d","getObstacles","filter","clear","updateCanvasSize","width","height","fbo_1","FluidShaders","Fluid","_useFloatTextures","viscosity","colorIntensity","color","reset","_FBO","freeTextures","freeShaders","_velTextures","deleteTexture","_tmpTexture","_pressureTexture","_divergenceTexture","freeShader","shader","_drawVelocityShader","_drawPressureShader","_addVelShader","_advectShader","_jacobiPressureShader","_divergenceShader","_substractGradientShader","_obstaclesVelocityShader","_width","_height","initTextures","buildShaders","_currIndex","set","bool","_nbIterations","ceil","currIndex","dt","timestep","clearColor","multiPoints","multiMousePoints","multiPoints_1","pt","strength","addVel","advect","obstaclesVelocity","project","addVelShader","bind","nextIndex","switchBuffers","drawVelocity","drawPressure","drawPressureShader","obstacleVelocityShader","texture","texelSize","advectShader","computeDivergence","divergenceShader","COLOR_BUFFER_BIT","computePressure","jacobiPressureShader","alpha","dst","cstTerm","index","textures","bindAttributes","bindUniforms","substractPressureGradient","substractGradientShader","floatTexels","floatData","Float32Array","uintTexels","uintData","Uint8Array","velFormat","FLOAT","UNSIGNED_BYTE","velData","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","textures_1","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","setUseFloatTextures","buildDrawVelocityShader","buildDrawPressureShader","buildAddVelShader","buildAdvectShader","buildJacobiPressureShader","buildDivergenceShader","buildSubstractGradientShader","buildObstaclesVelocityShader","FBO","createFramebuffer","colorBuffers","depthBuffer","bindFramebuffer","FRAMEBUFFER","viewport","framebufferTexture2D","bindRenderbuffer","RENDERBUFFER","framebufferRenderbuffer","DEPTH_ATTACHMENT","bindDefault","drawingBufferWidth","drawingBufferHeight","deleteFramebuffer","GLResource","_gl","notImplemented","location","alert","types","str","binder","uniform2fv","uniform3fv","uniform4fv","uniform2iv","uniform3iv","uniform4iv","uniform1i","uniformMatrix2fv","uniformMatrix3fv","uniformMatrix4fv","unitNb","activeTexture","TEXTURE_CUBE_MAP","isArray","uniform1iv","uniform1fv","uniform1f","ShaderProgram","vertexSource","fragmentSource","createShader","type","source","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","deleteShader","uCount","aCount","vertexShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","introspection","getProgramInfoLog","deleteProgram","ACTIVE_UNIFORMS","uniform","getActiveUniform","name_1","name","loc","getUniformLocation","ACTIVE_ATTRIBUTES","a","attribute","getActiveAttrib","name_2","VBO","getAttribLocation","useProgram","currTextureUnitNb","uName","aName","resizeCanvas","hidpi","cssPixel","devicePixelRatio","floor","array","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","normalize","stride","offset","deleteBuffer","createQuad","minX","minY","maxX","maxY","enableVertexAttribArray","vertexAttribPointer","Utils","brush_1","obstacle_map_1","fluid_1","Requirements","ws_mouse_1","mouse_point_renderer_1","dynamic_obstacle_controller_1","mousePointRenderer","MultiMouseWS","points","updatePoints","connect","Page","Canvas","getCanvas","flags","setError","message","Demopage","setErrorMessage","getContext","cursor","disable","CULL_FACE","DEPTH_TEST","BLEND","initGL","check","webgl","MousePointRenderer","loadExtensions","fluid","obstacleMaps","size_1","iX","iY","instantFPS","setInterval","setIndicatorText","lastUpdate","requestAnimationFrame","mainLoop","time","obstacleCount","addDynamicObstacleVelocityToFluid","stream","DEPTH_BUFFER_BIT","display","velocity","pressure","error","main","targetCanvas","dynamicObstacles","overlayCanvas","position","top","left","pointerEvents","zIndex","getComputedStyle","overlayCtx","ResizeObserver","observe","rect","getBoundingClientRect","render","clearRect","renderDynamicObstacles","x","y","drawPoint","drawMovement","sizeX","sizeY","drawObstacle","drawObstacleVelocity","ctx","beginPath","arc","PI","fillStyle","globalAlpha","fill","font","textAlign","textBaseline","fillText","toString","moveX","moveY","magnitude","endX","endY","moveTo","lineTo","strokeStyle","lineWidth","stroke","angle","atan2","headLength","cos","sin","hue","ellipse","velX","velY","ObstacleMapShaders","dynamic_obstacle_1","ObstacleMap","_fbo","_addShader","buildAddShader","_dynamicObstacleSystem","initObstaclesMap","_texture","_initTexture","addShader","updateDynamicObstacleTexture","resetToInitialState","obstacles_1","texels","data","tex","obstacles_2","influenceRadius","max","Mouse","_posInPx","_pivotInPx","setPosInPx","setMovementInPx","Observers","mouseMove","relX","relY","getSize","mouseDown","_pos","_movementInPx","_movement","toPivot","distToPivot","movementInPx","setRelative","brushInfo","ObstaclesInfo","fluidInfo","obstaclesInfo","NONE","displayInfo","RESOLUTIONS_CONTROL_ID","updateResolution","values","Tabs","addObserver","getValues","FLOAT_CONTROL_ID","allExtensionsLoaded","Controls","setVisibility","Checkbox","setChecked","updateFloat","useFloatTextures","isChecked","ITERATIONS_CONTROL_ID","updateIterations","iterations","minNbIterations","Range","getValue","TIMESTEP_CONTROL_ID","updateTimestep","STREAM_CONTROL_ID","updateStream","doStream","OBSTACLES_CONTROL_ID","updateObstacles","BRUSH_RADIUS_CONTROL_ID_1","updateBrushRadius_1","mouseWheel","delta","setValue","BRUSH_STRENGTH_CONTROL_ID","updateBrushStrength","DISPLAY_MODE_CONTROL_ID","updateDisplayMode","modes","COLOR_INTENSITY_CONTROL_ID","updateColorIntensity","intensity","DISPLAY_COLOR_CONTROL_ID","updateColor","DISPLAY_OBSTACLES_CONTROL_ID","updateDisplayObstacles","bindControls","getShaderPrecisionFormat","MEDIUM_FLOAT","precision","extensions","extensions_1","ext","getExtension","shader_1","vbo_1","drawSrc","ShaderSrc","vert","frag","fetch","filepath","request","XMLHttpRequest","open","send","responseText","batchReplace","includes","includes_1","include","replace","RegExp","toReplace","replacement","fromScript","vertId","fragId","getElementById","text","build_shaders_1","obstacle_map_shaders_1","rawEncodingStr","fullscreenVert","encodingStr","useFloat","drawVelocitySrc","drawPressureSrc","addVelSrc","advectSrc","jacobiPressureSrc","divergenceSrc","substractGradientSrc","obstaclesVelocitySrc","buildFullscreenShader","src","vertSrc","fragSrc","addSrc","url","onPointsUpdate","fps","ws","isConnected","sendInterval","WebSocket","onopen","startSendLoop","onclose","stopSendLoop","onerror","err","onmessage","ev","JSON","parse","interval","readyState","OPEN","clearInterval","disconnect","close","setFPS","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","module","__webpack_modules__"],"sourceRoot":""}